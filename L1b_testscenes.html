
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Evaluation on test scenes &#8212; CIMR L2 Multi Parameter Retrieval ATBD v2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/styles.css?v=3437f865" />
    <link rel="stylesheet" type="text/css" href="_static/watermark.css?v=dcb9ece5" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'L1b_testscenes';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Bibliography" href="references.html" />
    <link rel="prev" title="First assessment of the algorithm" href="first_assessment.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="CIMR L2 Multi Parameter Retrieval ATBD v2 - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="CIMR L2 Multi Parameter Retrieval ATBD v2 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    ATBD Multi Parameter Retrieval
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="abstract.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="applicable_ref_docs.html">Applicable and reference documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="acronyms.html">Acronyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction_purpose_scope.html">Introduction, purpose and scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="background_justification_algorithm.html">Background and justification of selected algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="L2_product_definition.html">Level-2 product definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="baseline_algorithm_definition.html">Baseline Algorithm Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithm_input_output_data_definition.html">Algorithm Input and Output Data Definition (IODD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_assessment.html">First assessment of the algorithm</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">L1b testscene</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="annex.html">Annex</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/CIMR-Algos/MultiParameter_ATBD" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/L1b_testscenes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Evaluation on test scenes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-of-the-reading-routines-for-the-data-handling">Illustration of the reading routines for the data handling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-of-l1b-data-without-resampling">Illustration of L1b data without resampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application-of-the-retrieval-on-the-l1b-data">Application of the retrieval on the L1b data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#devalgo-test-scene-1-radiometric-scene">DEVALGO test scene 1 - Radiometric scene</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-surface-classes-and-true-brightness-temperatures">Overview of surface classes and true brightness temperatures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieval-before-and-after-the-satellite-simulator-for-the-radiometric-scene">Retrieval before and after the satellite simulator for the radiometric scene</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-metrics-for-the-radiometric-scene">Performance metrics for the radiometric scene</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#devalgo-test-scene-2-geometric-scene">DEVALGO test scene 2 - Geometric scene</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieval-before-and-after-the-satellite-simulator-for-the-geometric-scene">Retrieval before and after the satellite simulator for the geometric scene</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-metrics-for-the-geometric-scene">Performance metrics for the geometric scene</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-scene-sceps-polar-scene">Test scene SCEPS - Polar scene</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correction-of-oza-variation">Correction of OZA variation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-results-example">Saving results (Example)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="evaluation-on-test-scenes">
<h1>Evaluation on test scenes<a class="headerlink" href="#evaluation-on-test-scenes" title="Link to this heading">#</a></h1>
<p>This notebook illustrates the use of the L1b CIMR data reader, the retrieval function to write the results to a file. Overall transitioning from the L1b file from the SCEPS or DEIMOS CIMR satellite simulator to a NetCDF file containing the retrieval results.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All code cells are executed when the notebook is run only requiring the source code in the <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> folder where the reader and algorithm is implemented in the Julia language. In addition a <code class="docutils literal notranslate"><span class="pre">common_functions.jl</span></code> is used, located in this folder.
In this notebook all cells are shown including output from the executed code.</p>
</div>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>The multi parameter retrieval was evaluated on the two DEVALGO test cards, as well as on the SCEPS polar test card. For the DEVALGO test cards, the performance is evaluated by analyzing the difference between the retrieval applied to the input brightness temperatures of the CIMR satellite simulator and the retrieval applied to the output of the simulator, i.e., the CIMR L1b data (from DEIMOS). The retrieval is also applied to the SCEPS polar scene where an absolute reference exists in the next section. The brightness temperature before and after the satellite simulator can be used as retrieval input to estimate the effect the CIMR satellite characteristics have on the multi parameter retrieval. In this section, all resampling was performed using a nearest neighbor interpolation. The variables retrieved in the multi parameter retrieval are wind speed <a class="reference internal" href="acronyms.html#term-WS"><span class="xref std std-term">WS</span></a>, total water vapor <a class="reference internal" href="acronyms.html#term-TWV"><span class="xref std std-term">TWV</span></a>, cloud liquid water <a class="reference internal" href="acronyms.html#term-CLW"><span class="xref std std-term">CLW</span></a>, sea surface temperature <a class="reference internal" href="acronyms.html#term-SST"><span class="xref std std-term">SST</span></a>, ice surface temperature <a class="reference internal" href="acronyms.html#term-IST"><span class="xref std std-term">IST</span></a>, sea ice concentration <a class="reference internal" href="acronyms.html#term-SIC"><span class="xref std std-term">SIC</span></a>, multi year ice fraction <a class="reference internal" href="acronyms.html#term-MYI"><span class="xref std std-term">MYI</span></a>, first year ice thickness <a class="reference internal" href="acronyms.html#term-SIT"><span class="xref std std-term">SIT</span></a>, and sea surface salinity <a class="reference internal" href="acronyms.html#term-SSS"><span class="xref std std-term">SSS</span></a>. In the following, the retrieval results are illustrated only for SIC, but the performance metrics are shown for all variables.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The DEVALGO test scenes 1 and 2 contain artificial patterns of different surface types at the geographic location around Svalbard. The geometric pattern shown in this scene, do not correspond to any real scenario and is only for the purpose of testing the retrieval algorithm. The scenes are generated by the DEVALGO team and are not real observations.</p>
</div>
</section>
<section id="illustration-of-the-reading-routines-for-the-data-handling">
<h2>Illustration of the reading routines for the data handling<a class="headerlink" href="#illustration-of-the-reading-routines-for-the-data-handling" title="Link to this heading">#</a></h2>
<p>First we are setting up some projection conversion. Since the <a class="reference internal" href="acronyms.html#term-CIMR"><span class="xref std std-term">CIMR</span></a> L1b data is not on a regular grid, the arrays can not be directly plotted on a map. Therefore, we need to convert the data to a projection that can be plotted on a map.</p>
<div class="highlight-julia notranslate" id="include-common-functions"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Pkg</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="s">&quot;../algorithm/algoenv&quot;</span><span class="p">)</span>
<span class="k">using</span><span class="w"> </span><span class="n">OEM</span>
<span class="k">using</span><span class="w"> </span><span class="n">IJulia</span>
<span class="k">using</span><span class="w"> </span><span class="n">Printf</span>
<span class="k">using</span><span class="w"> </span><span class="n">Markdown</span>
<span class="k">using</span><span class="w"> </span><span class="n">Proj</span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">NCDatasets</span>
<span class="k">using</span><span class="w"> </span><span class="n">PythonCall</span><span class="w"> </span><span class="c"># to call python from julia</span>
<span class="k">using</span><span class="w"> </span><span class="n">PythonPlot</span><span class="w"> </span><span class="c"># basically the matplotlib.pyplot module</span>
<span class="k">using</span><span class="w"> </span><span class="n">Statistics</span>
<span class="k">using</span><span class="w"> </span><span class="n">Markdown</span>
<span class="k">using</span><span class="w"> </span><span class="n">OrderedCollections</span>
<span class="n">pygc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyimport</span><span class="p">(</span><span class="s">&quot;gc&quot;</span><span class="p">)</span>
<span class="n">pr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyimport</span><span class="p">(</span><span class="s">&quot;pyresample&quot;</span><span class="p">)</span>
<span class="c">#cfeature = pyimport(&quot;cartopy.feature&quot;)</span>
<span class="n">basemap</span><span class="o">=</span><span class="w"> </span><span class="n">pyimport</span><span class="p">(</span><span class="s">&quot;mpl_toolkits.basemap&quot;</span><span class="p">)</span>
<span class="n">LLtoEASE2n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Proj</span><span class="o">.</span><span class="n">Transformation</span><span class="p">(</span><span class="s">&quot;epsg:4326&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;epsg:6931&quot;</span><span class="p">)</span>
<span class="n">EASE2NtoLL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inv</span><span class="p">(</span><span class="n">LLtoEASE2n</span><span class="p">)</span>

<span class="n">lltoxy</span><span class="o">=</span><span class="n">LLtoEASE2n</span><span class="w"> </span><span class="c">#conversion from lat/lon to EASE2 grid coordinates</span>
<span class="n">xytoll</span><span class="o">=</span><span class="n">EASE2NtoLL</span><span class="w"> </span><span class="c">#conversion from EASE2 grid coordinates to lat/lon</span>
<span class="n">lea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pr</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">AreaDefinition</span><span class="p">(</span><span class="s">&quot;ease2_nh_testscene&quot;</span><span class="p">,</span><span class="s">&quot;ease2_nh_testscene&quot;</span><span class="p">,</span><span class="s">&quot;ease2_nh_testscene&quot;</span><span class="p">,</span><span class="s">&quot;EPSG:6931&quot;</span><span class="p">,</span><span class="mi">1400</span><span class="p">,</span><span class="mi">1400</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5e6</span><span class="p">,</span><span class="mf">1.4e6</span><span class="p">,</span><span class="o">-</span><span class="mf">1e5</span><span class="p">])</span><span class="w"> </span><span class="c"># uses pyresample to define an area definition for the test region in the EASE2 grid</span>
<span class="n">leaextent</span><span class="o">=</span><span class="p">[</span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span><span class="w"> </span><span class="c">#extent for the image, since order differs from the order in the area definition</span>

<span class="c">#getting the landmask for the region</span>
<span class="n">lealons</span><span class="p">,</span><span class="n">lealats</span><span class="o">=</span><span class="n">lea</span><span class="o">.</span><span class="n">get_lonlats</span><span class="p">()</span>
<span class="n">landmask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basemap</span><span class="o">.</span><span class="n">maskoceans</span><span class="p">(</span><span class="n">lealons</span><span class="p">,</span><span class="n">lealats</span><span class="p">,</span><span class="n">lealats</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s">&quot;i&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mask</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">PyArray</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Array</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;.~</span><span class="n">x</span><span class="w"> </span>

<span class="c">#defining a cartopy crs</span>
<span class="n">ccrs</span><span class="o">=</span><span class="n">lea</span><span class="o">.</span><span class="n">to_cartopy_crs</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#can be aceesed like</span>
<span class="n">fns</span><span class="o">.</span><span class="n">scene1</span><span class="o">.</span><span class="n">l1b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;/DEVALGO/DATA/DEIMOS/W_PT-DME-Lisbon-SAT-CIMR-1B_C_DME_20230420T103323_LD_20280110T114800_20280110T115700_TN.nc&quot;
</pre></div>
</div>
</div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#the input files can be found on the ESA DEVALGO FTP server,</span>
<span class="c">#this is a named tuple with the paths to the input files</span>
<span class="n">fns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">scene1</span><span class="o">=</span>
<span class="w">        </span><span class="p">(;</span><span class="w"> </span><span class="n">l1b</span><span class="o">=</span><span class="n">joinpath</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span><span class="s">&quot;DEIMOS/W_PT-DME-Lisbon-SAT-CIMR-1B_C_DME_20230420T103323_LD_20280110T114800_20280110T115700_TN.nc&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">input</span><span class="o">=</span><span class="n">joinpath</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span><span class="s">&quot;DEVALGO/test_scene_1_compressed_lowres.nc&quot;</span><span class="p">)),</span>
<span class="w">        </span><span class="n">scene2</span><span class="o">=</span>
<span class="w">        </span><span class="p">(;</span><span class="w"> </span><span class="n">l1b</span><span class="o">=</span><span class="n">joinpath</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span><span class="s">&quot;DEIMOS/W_PT-DME-Lisbon-SAT-CIMR-1B_C_DME_20230417T105425_LD_20280110T114800_20280110T115700_TN.nc&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">input</span><span class="o">=</span><span class="n">joinpath</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span><span class="s">&quot;DEVALGO/test_scene_2_compressed_lowres.nc&quot;</span><span class="p">)),</span>
<span class="w">        </span><span class="n">scenep</span><span class="o">=</span>
<span class="w">        </span><span class="p">(;</span>
<span class="w">        </span><span class="n">l1b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinpath</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span><span class="s">&quot;SCEPS/SCEPS_l1b_sceps_geo_polar_scene_1_unfiltered_tot_minimal_nom_nedt_apc_tot_v2p1.nc&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinpath</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span><span class="s">&quot;SCEPS/cimr_sceps_toa_card_devalgo_polarscene_1_20161217_v2p0_aa_000.nc&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="n">geo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinpath</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span><span class="s">&quot;SCEPS/cimr_sceps_geo_card_devalgo_polarscene_1_20161217_harmonised_v2p0_surface.nc&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Simple data reading for a single band can be done with the <code class="docutils literal notranslate"><span class="pre">get_data_for_band</span></code> function. It only requires the filename of the L1b data and the band to be read. It gets a named tuple with, <code class="docutils literal notranslate"><span class="pre">h</span></code>, <code class="docutils literal notranslate"><span class="pre">v</span></code>, <code class="docutils literal notranslate"><span class="pre">lat</span></code> and <code class="docutils literal notranslate"><span class="pre">lon</span></code>. All arrays are 1d arrays. <code class="docutils literal notranslate"><span class="pre">h</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code> are the horizontal and vertical brightness temperatures, <code class="docutils literal notranslate"><span class="pre">lat</span></code> and <code class="docutils literal notranslate"><span class="pre">lon</span></code> are the latitude and longitude coordinates. The position in the scan is ignored as the scan direction is already selected by passing “forward” or “backward” to the function. Since this is a raw reader, there is no interpolation or other processing done on the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">cband_data</span><span class="o">=</span><span class="n">get_data_for_band</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scene1</span><span class="o">.</span><span class="n">l1b</span><span class="p">,</span><span class="s">&quot;C_BAND&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">keys</span><span class="p">(</span><span class="n">cband_data</span><span class="p">)</span><span class="w"> </span><span class="c">#a named tuple with the keys: h, v, lat, lon,  herr, verr, oza</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">cband_data</span><span class="o">.</span><span class="n">h</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>keys(cband_data) = (:h, :v, :herr, :verr, :lat, :lon, :oza)
size(cband_data.h) = (389932,)
</pre></div>
</div>
</div>
</div>
<p>Another possibility is the <code class="docutils literal notranslate"><span class="pre">project_data</span></code> data function. This also reads a file
by name, but also resamples the data onto the closest grid point of the selected
band. The output is three arrays with the reprojected brightness temperatures
for each band, and the latitude and longitude coordinates of the grid points.
The grid points are the same for all bands. The function also takes the scan
direction as an argument. The projected brightness temperatures have the
different channel as second dimension, starting with the lowest frequency at <code class="docutils literal notranslate"><span class="pre">v</span></code>
pol. The <code class="docutils literal notranslate"><span class="pre">h</span></code> pol is the next channel, followed by the next higher frequency at
<code class="docutils literal notranslate"><span class="pre">v</span></code> pol and so on, i.e., 10 dimensions in the order <code class="docutils literal notranslate"><span class="pre">L_band_v</span></code>, <code class="docutils literal notranslate"><span class="pre">L_band_h</span></code>,
<code class="docutils literal notranslate"><span class="pre">C_band_v</span></code>, <code class="docutils literal notranslate"><span class="pre">C_band_h</span></code>, <code class="docutils literal notranslate"><span class="pre">X_band_v</span></code>, <code class="docutils literal notranslate"><span class="pre">X_band_h</span></code>, <code class="docutils literal notranslate"><span class="pre">Ku_band_v</span></code>, <code class="docutils literal notranslate"><span class="pre">Ku_band_h</span></code>,
<code class="docutils literal notranslate"><span class="pre">Ka_band_v</span></code>, <code class="docutils literal notranslate"><span class="pre">Ka_band_h</span></code>. Here we store forward and backward scans in different
arrays, to be able to assess them separately.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The resampling is done by finding the closest grid point in the projection. This is the simplest possible resampling and might not be the best choice for all applications.</p>
</div>
<p>Here we fill the arrays with the data from the DEVALGO test scene 1, which is the radiometric scene, with the forward and backward scans in separate arrays, accessed as dictionaries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">band_data</span><span class="o">=</span><span class="kt">Dict</span><span class="p">()</span>
<span class="n">band_error</span><span class="o">=</span><span class="kt">Dict</span><span class="p">()</span>
<span class="n">latc</span><span class="o">=</span><span class="kt">Dict</span><span class="p">()</span>
<span class="n">lonc</span><span class="o">=</span><span class="kt">Dict</span><span class="p">()</span>
<span class="n">xc</span><span class="o">=</span><span class="kt">Dict</span><span class="p">()</span>
<span class="n">yc</span><span class="o">=</span><span class="kt">Dict</span><span class="p">()</span>
<span class="k">for</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">band_data</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="n">band_error</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="n">latc</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="n">lonc</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span><span class="o">=</span><span class="n">project_data</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scene1</span><span class="o">.</span><span class="n">l1b</span><span class="p">,</span><span class="s">&quot;C_BAND&quot;</span><span class="p">,</span><span class="n">dir</span><span class="p">)</span>
<span class="w">    </span><span class="n">xc</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="n">yc</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span><span class="o">=</span><span class="n">lltoxy</span><span class="o">.</span><span class="p">(</span><span class="n">latc</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="n">lonc</span><span class="p">[</span><span class="n">dir</span><span class="p">])</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">last</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nd">@eval</span><span class="p">(</span><span class="nd">@show</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">band_data</span><span class="p">[</span><span class="o">$</span><span class="n">dir</span><span class="p">])))</span>
<span class="w">    </span><span class="nd">@eval</span><span class="p">(</span><span class="nd">@show</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">latc</span><span class="p">[</span><span class="o">$</span><span class="n">dir</span><span class="p">])));</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size(band_data[&quot;forward&quot;]) = (366644, 10)
size(latc[&quot;forward&quot;]) = (366644,)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size(band_data[&quot;backward&quot;]) = (389932, 10)
size(latc[&quot;backward&quot;]) = (389932,)
</pre></div>
</div>
</div>
</div>
<section id="illustration-of-l1b-data-without-resampling">
<h3>Illustration of L1b data without resampling<a class="headerlink" href="#illustration-of-l1b-data-without-resampling" title="Link to this heading">#</a></h3>
<p>Here it can be seen that the number of data points is different for the different scans. The forward scan contains fewer data points as the calibration is also in forward direction.</p>
<p>Since the data is not on a regular grid, it cannot be plotted directly in the array as it is stored but has to be converted to earth coordinates and possibly resampled. The projection and grid of choice is the EASE2 Northern hemisphere grid. In <a class="reference internal" href="#scene-scatter"><span class="std std-numref">Fig. 8</span></a> is a scatter plot of all the data points of the CIMR L1b data in the EASE2 projection for both viewing directions, forward and backward, is shown individually. For the DEVALGO test scenes, the brightness temperatures outside of the test scene area are 0 K. This is why the data points are only visible in the test scene area. Small structures in the data are visible corresponding to scan lines. Exemplary, only TBh at C-band is shown in <a class="reference internal" href="#scene-scatter"><span class="std std-numref">Fig. 8</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">axs</span><span class="o">=</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">dir</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">([</span><span class="s">&quot;forward&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">])</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="c">#python indexing starts at 0</span>
<span class="w">    </span><span class="nd">@show</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">xc</span><span class="p">[</span><span class="n">dir</span><span class="p">])</span>
<span class="w">    </span><span class="nd">@show</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">yc</span><span class="p">[</span><span class="n">dir</span><span class="p">])</span>

<span class="w">    </span><span class="nd">@show</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">band_data</span><span class="p">[</span><span class="n">dir</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="w">    </span><span class="n">img</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="nb">im</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xc</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="n">yc</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">band_data</span><span class="p">[</span><span class="n">dir</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">260</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="w">    </span><span class="c">#img=axs[im].scatter(xc[dir],yc[dir],c=band_error[dir][:,4], vmin=0,vmax=2,s=0.05)</span>
<span class="w">    </span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="nb">im</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;TBh C-band [K]&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="p">[</span><span class="nb">im</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">dir</span><span class="o">*</span><span class="s">&quot; scan, scene 1&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="p">[</span><span class="nb">im</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&quot;equal&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="p">[</span><span class="nb">im</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;EASE2 North x (km)&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">axs</span><span class="p">[</span><span class="nb">im</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;EASE2 North y (km)&quot;</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C-band TBh forward (upper pane) and backward (lower pane) scans for scene 1.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scene_scatter&quot;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">fig</span><span class="o">=</span><span class="nb">nothing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size(xc[dir]) = (366644,)
size(yc[dir]) = (366644,)
size((band_data[dir])[:, 4]) = (366644,)
size(xc[dir]) = 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(389932,)
size(yc[dir]) = (389932,)
size((band_data[dir])[:, 4]) = (389932,)
</pre></div>
</div>
<figure class="align-default" id="scene-scatter">
<img alt="_images/figure_scene_scatter.png" src="_images/figure_scene_scatter.png" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">C-band TBh forward (upper pane) and backward (lower pane) scans for scene 1.</span><a class="headerlink" href="#scene-scatter" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="application-of-the-retrieval-on-the-l1b-data">
<h3>Application of the retrieval on the L1b data<a class="headerlink" href="#application-of-the-retrieval-on-the-l1b-data" title="Link to this heading">#</a></h3>
<p>Now we can apply the Multi parameter retrieval using the simple user function <code class="docutils literal notranslate"><span class="pre">run_oem</span></code>. It takes the band data as produced by the <code class="docutils literal notranslate"><span class="pre">project_data</span></code> function, i.e., a matrix with (n, 10) dimensions, where n is the number of data points, and 10 is the number of channels. It returns the retrieved parameters similarly as (n, 9) matrix, where the columns are the retrieved parameters. The columns are the same as in the L1b data, i.e., <code class="docutils literal notranslate"><span class="pre">wind</span> <span class="pre">speed</span></code>, <code class="docutils literal notranslate"><span class="pre">total</span> <span class="pre">water</span> <span class="pre">vapor</span></code>, <code class="docutils literal notranslate"><span class="pre">cloud</span> <span class="pre">liquid</span> <span class="pre">water</span></code>, <code class="docutils literal notranslate"><span class="pre">sea</span> <span class="pre">surface</span> <span class="pre">temperature</span></code>, <code class="docutils literal notranslate"><span class="pre">ice</span> <span class="pre">surface</span> <span class="pre">temperature</span></code>, <code class="docutils literal notranslate"><span class="pre">sea</span> <span class="pre">ice</span> <span class="pre">concentration</span></code>, <code class="docutils literal notranslate"><span class="pre">multi</span> <span class="pre">year</span> <span class="pre">ice</span> <span class="pre">fraction</span></code>, <code class="docutils literal notranslate"><span class="pre">first</span> <span class="pre">year</span> <span class="pre">ice</span> <span class="pre">thickness</span></code>, <code class="docutils literal notranslate"><span class="pre">sea</span> <span class="pre">surface</span> <span class="pre">salinity</span></code>. The retrieval is done for each scan separately, i.e., the forward and backward scan are retrieved separately.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>wind speed [m/s]</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>total water vapor [kg/m²]</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>cloud liquid water [kg/m²]</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>sea surface temperature [K]</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>ice surface temperature [K]</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>sea ice concentration [1]</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>multi year ice fraction [1]</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>first year ice thickness [cm]</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>sea surface salinity [ppt]</p></td>
</tr>
</tbody>
</table>
</div>
<p>The routine also returns the square root of the diagonal of the error covariance matrix of the retrieval and the residuals to the input brightness temperatures, together with the number of iterations.</p>
<p>Here, as an example, we are applying the retrieval to the forward scan and collect the returned variables in a named tuple.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">scene1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Dict</span><span class="p">()</span>
<span class="k">for</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">pygc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="w">    </span><span class="n">GC</span><span class="o">.</span><span class="n">gc</span><span class="p">()</span>
<span class="w">    </span><span class="n">dat</span><span class="p">,</span><span class="n">errr</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">its</span><span class="o">=</span><span class="n">run_oem</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">band_data</span><span class="p">[</span><span class="n">dir</span><span class="p">]))</span><span class="c">#,band_error[dir])</span>
<span class="w">    </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xc</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="n">yc</span><span class="p">[</span><span class="n">dir</span><span class="p">];</span><span class="w"> </span><span class="c">#results from the project_data function above, all still in the scan geometry</span>
<span class="w">    </span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">latc</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="n">lonc</span><span class="p">[</span><span class="n">dir</span><span class="p">];</span>
<span class="w">    </span><span class="n">scene1</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(;</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">errr</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">its</span><span class="p">)</span><span class="w"> </span><span class="c"># a named tuple with the results</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p>We are providing a cut out of our region of interest, i.e., the location of the test card, in EASE2 projection. This is defined here with the <code class="docutils literal notranslate"><span class="pre">pyresample</span></code> python package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">lea</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">AreaDefinition</span><span class="p">(</span><span class="s">&quot;ease2_nh_testscene&quot;</span><span class="p">,</span><span class="s">&quot;ease2_nh_testscene&quot;</span><span class="p">,</span><span class="s">&quot;ease2_nh_testscene&quot;</span><span class="p">,</span><span class="s">&quot;EPSG:6931&quot;</span><span class="p">,</span><span class="mi">1400</span><span class="p">,</span><span class="mi">1400</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5e6</span><span class="p">,</span><span class="mf">1.4e6</span><span class="p">,</span><span class="o">-</span><span class="mf">1e5</span><span class="p">]);</span><span class="w"> </span><span class="c">#uses pyresample to define an area definition for the test region in the EASE2 grid</span>
<span class="n">leaextent</span><span class="o">=</span><span class="p">[</span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span><span class="w"> </span><span class="c">#extent for the image, since order differs from the order in the area definition</span>

<span class="c">#getting the landmask for the region</span>
<span class="n">lealons</span><span class="p">,</span><span class="n">lealats</span><span class="o">=</span><span class="n">lea</span><span class="o">.</span><span class="n">get_lonlats</span><span class="p">()</span>
<span class="n">landmask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basemap</span><span class="o">.</span><span class="n">maskoceans</span><span class="p">(</span><span class="n">lealons</span><span class="p">,</span><span class="n">lealats</span><span class="p">,</span><span class="n">lealats</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s">&quot;i&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mask</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">PyArray</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Array</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;.~</span><span class="n">x</span><span class="w"> </span>

<span class="c">#defining a cartopy crs</span>
<span class="n">ccrs</span><span class="o">=</span><span class="n">lea</span><span class="o">.</span><span class="n">to_cartopy_crs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="180.72pt" height="180.72pt" viewBox="0 0 180.72 180.72" xmlns="http://www.w3.org/2000/svg" version="1.1">
 <metadata>
  <rdf:RDF xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <cc:Work>
    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
    <dc:date>2025-03-25T14:48:23.399819</dc:date>
    <dc:format>image/svg+xml</dc:format>
    <dc:creator>
     <cc:Agent>
      <dc:title>Matplotlib v3.8.4, https://matplotlib.org/</dc:title>
     </cc:Agent>
    </dc:creator>
   </cc:Work>
  </rdf:RDF>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linejoin: round; stroke-linecap: butt}</style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 180.72 
L 180.72 180.72 
L 180.72 0 
L 0 0 
z
" style="fill: #ffffff"/>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 7.2 173.52 
L 7.2 7.2 
L 173.52 7.2 
L 173.52 173.52 
L 7.2 173.52 
" style="fill: #ffffff"/>
   </g>
   <g id="FeatureArtist_1">
    <path d="M 113.989617 49.460394 
L 114.289833 48.445506 
L 114.509639 47.992774 
L 114.524635 47.44399 
L 114.143212 47.096872 
L 113.34262 46.607468 
L 112.929499 46.304529 
L 112.611111 46.027931 
L 112.566487 45.407158 
L 112.778415 44.996815 
L 113.306398 44.73571 
L 113.73584 44.609724 
L 114.426173 44.616389 
L 114.96557 44.699817 
L 115.530074 45.008757 
L 116.023596 45.207514 
L 116.529106 45.288469 
L 117.482284 46.751424 
L 117.833635 47.975007 
L 117.385003 50.559506 
L 117.23426 50.932203 
L 116.874205 51.196618 
L 116.051434 51.357057 
L 115.121374 51.451692 
L 114.826381 51.125906 
L 114.566783 50.453235 
L 113.989617 49.460394 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 117.275061 65.736823 
L 116.990528 65.716829 
L 116.529989 65.558614 
L 114.954138 64.725379 
L 114.504739 64.442127 
L 114.16532 64.290833 
L 113.497889 64.130887 
L 113.154924 64.098666 
L 112.947069 63.796317 
L 113.684966 63.101008 
L 114.923872 61.383795 
L 116.03996 60.790888 
L 116.515747 60.702883 
L 117.188348 60.741978 
L 116.472332 62.550179 
L 116.573809 62.913141 
L 117.134354 63.254639 
L 117.619277 63.634948 
L 117.568313 63.849475 
L 118.141155 64.761574 
L 118.16609 65.198812 
L 117.275061 65.736823 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 72.989934 141.448043 
L 72.263012 142.260667 
L 71.695552 142.356627 
L 70.356826 141.753423 
L 69.635574 141.580017 
L 69.224638 140.370133 
L 69.593046 139.746243 
L 69.661019 139.300567 
L 69.216368 138.963748 
L 68.362003 138.579 
L 67.967184 138.555888 
L 67.392109 138.97035 
L 66.800665 139.569517 
L 66.35853 139.566903 
L 65.231214 137.469203 
L 63.985232 135.564099 
L 63.280243 135.91757 
L 62.827571 135.761158 
L 62.442603 135.886719 
L 61.633947 136.779256 
L 60.13353 137.938122 
L 59.966592 138.519952 
L 60.630766 139.200383 
L 61.067157 138.933663 
L 61.421141 140.122796 
L 62.416769 140.782974 
L 62.970312 141.790344 
L 63.962272 142.917758 
L 64.667756 143.400614 
L 66.210323 143.960255 
L 66.13056 144.097886 
L 66.170226 145.556045 
L 66.110146 146.150788 
L 66.183149 146.983436 
L 66.485867 148.15959 
L 65.864526 149.16354 
L 66.509739 150.408379 
L 66.927787 150.512065 
L 68.844644 149.005616 
L 69.34775 148.702842 
L 69.738534 148.149603 
L 69.911631 147.490433 
L 70.041831 147.422082 
L 70.607538 147.494744 
L 70.760375 147.375151 
L 70.957936 147.494861 
L 71.014572 148.03154 
L 70.740216 149.156283 
L 71.207809 149.950637 
L 71.305958 150.323792 
L 71.268969 150.555657 
L 71.861327 151.013278 
L 72.488109 150.620937 
L 72.570405 150.077101 
L 72.578287 149.366412 
L 72.734125 148.952447 
L 73.507548 148.688251 
L 73.729255 148.289022 
L 74.021956 147.284208 
L 74.111892 146.734514 
L 74.091436 145.878891 
L 73.980401 144.876089 
L 74.008538 144.4643 
L 75.466118 142.374293 
L 74.190234 141.831968 
L 72.989934 141.448043 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 114.1869 51.959643 
L 113.710957 52.309657 
L 113.376925 52.73573 
L 113.441941 53.453994 
L 113.354437 54.598568 
L 113.258961 55.370383 
L 113.076954 55.764973 
L 112.61505 55.606379 
L 112.34272 55.7931 
L 112.080105 56.568144 
L 112.174445 56.927143 
L 112.503468 57.226216 
L 112.639452 57.440688 
L 113.13551 58.003722 
L 114.125129 58.791721 
L 114.617945 59.130075 
L 115.217172 59.444698 
L 115.451837 59.476756 
L 116.631742 59.39542 
L 116.74095 58.818169 
L 116.602649 57.777045 
L 117.772452 57.313878 
L 118.312436 56.780718 
L 117.563782 55.779573 
L 117.540212 54.987049 
L 117.029517 54.503472 
L 116.948975 54.243011 
L 117.076801 53.556249 
L 116.336141 53.069131 
L 115.869685 52.63491 
L 115.154968 52.171432 
L 114.623218 52.035078 
L 114.1869 51.959643 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 98.694724 80.607271 
L 98.438987 79.97129 
L 98.460413 79.83327 
L 98.701045 79.743185 
L 98.198361 78.955786 
L 98.210569 78.679872 
L 97.810896 78.058835 
L 97.7353 77.685554 
L 97.926329 77.651007 
L 99.175133 78.006 
L 100.394695 77.408523 
L 100.438621 77.279445 
L 99.603425 76.536909 
L 98.798593 76.2247 
L 98.388195 76.150685 
L 98.117967 76.196341 
L 97.929598 76.318434 
L 97.547886 76.956978 
L 96.494095 77.30943 
L 96.372824 77.455606 
L 96.268477 78.317832 
L 96.517404 79.197203 
L 96.015808 80.112883 
L 94.992972 82.732226 
L 95.039765 83.451597 
L 95.532271 83.193367 
L 96.261313 83.179326 
L 96.866824 83.003183 
L 97.058546 82.189265 
L 97.413496 82.366278 
L 98.011887 82.832842 
L 98.489607 83.042972 
L 98.754998 82.573324 
L 98.781322 82.185906 
L 98.322396 81.418116 
L 98.204267 81.145464 
L 98.694724 80.607271 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 103.139856 71.7577 
L 100.923038 71.438649 
L 100.524744 71.43089 
L 100.065145 72.058921 
L 99.693084 72.168909 
L 99.520645 72.445492 
L 99.27422 73.937102 
L 99.351916 74.739046 
L 100.310456 75.839903 
L 100.935443 76.251176 
L 101.899187 77.104686 
L 102.188252 77.636834 
L 101.59452 78.466506 
L 100.869063 78.29419 
L 100.672857 78.301394 
L 100.604327 78.52223 
L 100.636182 78.83752 
L 100.325016 79.477307 
L 100.25069 80.120165 
L 100.417792 81.029357 
L 100.663226 83.56658 
L 101.218271 83.800114 
L 101.581718 83.808159 
L 102.331723 84.059661 
L 102.7544 83.653807 
L 102.819177 83.421857 
L 102.569718 82.880849 
L 102.723491 82.415444 
L 103.162864 82.050495 
L 103.553026 82.145073 
L 103.764872 83.115994 
L 104.0105 83.619727 
L 104.468067 83.711433 
L 104.712038 83.30549 
L 104.737244 83.063491 
L 104.619778 82.742357 
L 104.62558 82.528971 
L 105.323491 82.48029 
L 105.304418 82.216862 
L 104.927389 81.682759 
L 104.712343 81.426144 
L 104.633597 81.274478 
L 105.296753 81.20519 
L 105.496182 81.093716 
L 105.551741 80.883577 
L 105.154124 80.437983 
L 104.775832 80.168827 
L 104.497346 80.019903 
L 104.330821 79.987042 
L 103.851899 80.263756 
L 103.737294 80.198619 
L 103.401724 79.505521 
L 103.372423 79.228099 
L 104.30148 78.00094 
L 104.108823 77.231294 
L 103.573942 76.907128 
L 103.452255 76.527101 
L 103.762296 75.545409 
L 104.574324 74.282429 
L 104.175723 73.440545 
L 104.062724 71.807652 
L 103.361802 71.561459 
L 103.139856 71.7577 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 173.52 60.009698 
L 173.01079 59.301708 
L 172.502792 59.244268 
L 171.934243 58.916947 
L 171.401539 58.542842 
L 170.718467 58.378104 
L 170.319177 58.349669 
L 169.131841 58.457448 
L 168.122887 58.755474 
L 166.903204 59.788245 
L 166.233488 60.700551 
L 166.146147 61.044052 
L 166.367834 62.019958 
L 166.340847 63.433159 
L 167.000719 65.317257 
L 167.556481 66.504175 
L 168.126503 67.107505 
L 168.902848 67.778904 
L 169.17507 68.266848 
L 169.031774 68.604467 
L 169.022659 68.969925 
L 169.337579 69.861475 
L 169.409101 70.280857 
L 169.281064 70.648892 
L 169.267148 71.065406 
L 169.639451 72.078357 
L 169.879485 73.041466 
L 169.395525 76.095221 
L 169.460389 78.097545 
L 169.085745 78.582161 
L 168.803677 79.549201 
L 168.328942 80.139627 
L 167.084195 81.095472 
L 166.670664 81.655445 
L 166.303074 82.781652 
L 166.332739 82.95979 
L 166.612322 83.558708 
L 167.35248 83.959132 
L 167.945206 84.224921 
L 168.210482 84.577819 
L 168.330607 84.848812 
L 168.138387 85.261104 
L 167.622601 85.232465 
L 167.374341 85.550944 
L 166.998785 86.544161 
L 167.080449 87.187903 
L 167.892003 87.960503 
L 167.911473 88.924165 
L 167.635122 90.40307 
L 167.617999 91.288461 
L 167.446423 91.62584 
L 167.446266 92.058265 
L 167.935553 93.230454 
L 168.173006 94.280165 
L 168.180914 95.68442 
L 168.698241 95.95115 
L 169.030856 96.075713 
L 169.43831 97.552579 
L 169.884435 98.132233 
L 170.835992 99.040235 
L 170.959899 99.217787 
L 170.050374 99.861027 
L 169.541308 100.39355 
L 169.457666 100.73383 
L 169.451102 101.314528 
L 169.639526 101.579095 
L 170.234235 101.887592 
L 170.688857 101.993559 
L 171.726047 103.927294 
L 171.582832 104.183475 
L 170.938931 104.152946 
L 170.46225 104.249028 
L 169.978229 104.446084 
L 169.652985 104.749341 
L 169.715178 105.265427 
L 169.975229 105.900162 
L 170.36957 106.121725 
L 170.797723 106.237363 
L 171.661859 106.259082 
L 172.210506 105.201805 
L 172.823918 105.241491 
L 173.132463 105.153589 
L 173.242948 106.40108 
L 173.52 107.275576 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 66.116171 111.6471 
L 65.162398 111.896845 
L 63.939622 112.501876 
L 63.691377 112.432624 
L 63.394663 112.256746 
L 62.862452 112.169409 
L 61.466573 112.189767 
L 61.086328 112.015911 
L 60.981757 112.054904 
L 60.816945 112.355774 
L 60.628855 112.306253 
L 60.006864 111.717846 
L 59.764889 111.751552 
L 59.898623 112.142266 
L 59.946621 112.50008 
L 59.80324 112.679811 
L 59.363121 112.739803 
L 59.314805 113.631331 
L 59.340252 114.1665 
L 58.790226 114.804963 
L 58.249793 114.92039 
L 57.7984 113.235014 
L 57.520908 112.444536 
L 57.422207 111.848269 
L 57.180023 111.644 
L 56.544463 111.523112 
L 56.344595 111.679256 
L 56.316995 112.207097 
L 56.174793 112.558506 
L 55.903196 112.617081 
L 55.774131 112.873846 
L 55.891705 113.350424 
L 56.238613 114.024877 
L 56.827077 115.470225 
L 57.194314 116.757446 
L 57.213319 117.327263 
L 56.948943 117.285483 
L 55.967102 116.645721 
L 55.68817 116.667825 
L 55.410522 116.488131 
L 55.033012 115.795107 
L 54.691992 115.582384 
L 53.553166 116.08397 
L 53.2886 116.027693 
L 52.630094 115.58879 
L 51.83574 114.857099 
L 51.457849 114.584535 
L 50.794442 114.419735 
L 50.082853 114.09875 
L 49.808766 114.104086 
L 49.629902 114.382602 
L 50.057946 115.074837 
L 50.456363 115.619692 
L 50.645065 115.924938 
L 50.771656 116.330045 
L 50.965192 117.208972 
L 50.475532 117.063861 
L 49.643265 116.333109 
L 49.452544 116.219349 
L 49.291486 116.337703 
L 49.375084 116.724088 
L 49.615938 117.18083 
L 50.303976 118.030038 
L 50.792428 118.168296 
L 50.581745 118.898935 
L 50.052768 118.771913 
L 49.507273 118.455079 
L 49.035025 118.355288 
L 47.642453 119.131013 
L 47.383342 119.604709 
L 48.04864 120.079068 
L 48.65584 120.349835 
L 49.869703 120.261318 
L 49.75854 120.862815 
L 49.594035 121.330401 
L 49.002394 122.049803 
L 49.240884 122.55336 
L 49.44438 122.870677 
L 49.821366 123.235603 
L 50.754277 123.810928 
L 51.345513 123.950072 
L 52.414965 123.714851 
L 52.938997 123.500339 
L 53.451367 123.097518 
L 53.796102 122.488623 
L 54.561983 122.26046 
L 55.399837 122.313237 
L 55.377434 122.906656 
L 55.182985 123.214885 
L 55.290766 123.989388 
L 54.604342 124.250733 
L 54.180498 124.293882 
L 53.773623 124.533936 
L 53.675723 124.7892 
L 53.632057 125.181008 
L 54.40096 125.709823 
L 55.120382 126.069 
L 55.859648 126.165263 
L 56.786252 126.125974 
L 57.038395 126.482113 
L 57.220463 126.57775 
L 59.700808 125.844645 
L 61.708827 124.577367 
L 61.747483 125.747429 
L 62.291116 126.446025 
L 62.726327 126.745478 
L 64.814727 126.204959 
L 65.3068 126.150949 
L 65.61487 125.7071 
L 65.636339 125.002542 
L 65.714736 124.414434 
L 66.192556 123.281305 
L 66.383953 123.154519 
L 67.216686 123.179712 
L 67.391329 123.007051 
L 67.95479 121.891319 
L 67.932319 121.363965 
L 67.616681 119.731911 
L 67.519576 118.961365 
L 67.631056 118.018072 
L 68.332898 114.887661 
L 68.331683 114.276373 
L 67.306883 112.535182 
L 66.640635 111.892353 
L 66.116171 111.6471 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 60.298098 135.656269 
L 61.188073 135.260348 
L 61.437839 134.836014 
L 61.592868 134.194359 
L 61.141357 133.585378 
L 60.334128 133.094419 
L 59.192444 132.766624 
L 58.319765 132.04105 
L 58.591229 130.84211 
L 58.000855 130.394489 
L 57.536033 130.24982 
L 56.764781 130.304269 
L 56.744902 130.602058 
L 56.962569 131.201418 
L 56.532088 131.646303 
L 55.788073 130.642465 
L 55.044834 130.502863 
L 54.178627 131.06699 
L 53.821867 130.881088 
L 53.35217 130.272557 
L 52.987754 130.034358 
L 52.759463 130.091315 
L 52.781286 129.038561 
L 52.379946 127.919639 
L 51.964133 127.202698 
L 51.228519 126.288382 
L 50.498377 125.987395 
L 50.400575 126.160382 
L 50.123346 128.522888 
L 49.881019 129.309575 
L 49.649687 128.060564 
L 49.33328 127.440525 
L 49.318459 126.035025 
L 49.256301 125.093827 
L 48.593174 123.977884 
L 47.679466 123.095928 
L 46.659078 122.638795 
L 46.026393 122.582234 
L 45.826293 123.363716 
L 44.811232 122.098168 
L 44.387493 121.781278 
L 44.087905 121.912006 
L 43.906628 122.544368 
L 44.019065 123.245913 
L 44.371093 124.100626 
L 44.225469 124.820442 
L 44.461649 126.858668 
L 45.184601 128.886278 
L 48.294164 135.45378 
L 48.155501 135.426532 
L 46.442727 133.462381 
L 46.16349 133.344434 
L 45.697116 132.644361 
L 42.727223 127.426527 
L 41.910561 126.399252 
L 41.257747 126.129115 
L 41.007962 127.186448 
L 40.891445 128.678506 
L 40.674749 129.183245 
L 40.93935 130.529217 
L 41.424112 132.284042 
L 41.265412 132.384735 
L 40.85601 131.995735 
L 40.40825 131.378405 
L 40.048027 131.084306 
L 39.460044 130.905693 
L 39.055679 129.724914 
L 38.737167 129.619794 
L 37.242059 130.213912 
L 38.035437 128.466668 
L 39.653694 127.67173 
L 39.8376 126.994523 
L 39.646208 126.290231 
L 39.002376 125.84917 
L 37.754853 126.543643 
L 37.106719 127.451017 
L 36.76554 127.562152 
L 35.900753 127.17487 
L 35.811249 127.438568 
L 36.207879 128.498461 
L 35.999175 128.463227 
L 35.707684 128.276562 
L 34.55757 127.3975 
L 33.785261 127.840703 
L 33.607479 128.072268 
L 33.548701 128.998029 
L 33.203855 128.482565 
L 32.537508 128.093457 
L 32.428877 128.250071 
L 32.354278 128.673232 
L 32.424234 128.991564 
L 32.94431 130.139067 
L 32.952472 131.285897 
L 33.06937 131.739034 
L 33.688907 133.029152 
L 34.176686 134.421976 
L 34.679671 135.291603 
L 35.191273 136.581373 
L 35.566832 136.782637 
L 35.905707 136.14643 
L 35.996097 135.399995 
L 35.699197 134.406374 
L 35.920225 134.25752 
L 36.640789 134.086184 
L 36.966172 134.356395 
L 36.951136 135.094791 
L 36.81548 135.943423 
L 37.101163 136.896626 
L 37.657175 138.04863 
L 37.782832 138.130543 
L 38.195328 138.038285 
L 38.524258 138.087896 
L 38.632071 138.241764 
L 38.448439 138.940508 
L 36.415392 138.310611 
L 36.213358 138.485932 
L 36.045452 138.824321 
L 36.839512 139.571389 
L 37.60723 140.100554 
L 37.39405 140.417749 
L 37.69788 141.638978 
L 38.380046 142.494029 
L 38.935741 142.872942 
L 39.274125 142.946166 
L 40.047136 144.286299 
L 40.92865 145.417578 
L 41.622448 145.98443 
L 41.825176 146.346492 
L 42.641482 147.018548 
L 43.952701 146.602133 
L 44.550953 146.1622 
L 45.071362 145.975921 
L 45.692154 144.163349 
L 45.978448 143.786029 
L 45.581278 143.243566 
L 45.187105 142.929458 
L 44.919962 141.116911 
L 44.675071 140.56845 
L 45.085267 139.840435 
L 45.222206 139.804468 
L 45.39716 139.968308 
L 45.872348 140.745155 
L 46.220179 140.779663 
L 46.409631 140.262074 
L 46.470641 138.645632 
L 46.65933 138.730849 
L 46.853083 139.362076 
L 46.947147 140.130966 
L 46.966384 141.139294 
L 47.590357 142.35753 
L 47.787891 142.498987 
L 48.470558 142.335122 
L 49.06733 141.868757 
L 49.447365 141.139838 
L 49.951894 139.366639 
L 50.557487 139.084545 
L 50.533944 139.790869 
L 50.316897 141.360871 
L 50.743286 141.987303 
L 51.645961 142.42791 
L 52.09692 142.24644 
L 52.493861 141.894603 
L 52.245487 142.630207 
L 51.7363 143.046072 
L 50.108986 143.493389 
L 49.253256 144.092741 
L 49.023824 144.541507 
L 49.385399 145.418979 
L 48.899179 145.48458 
L 48.473469 145.763147 
L 47.800443 146.898719 
L 46.081147 148.435664 
L 46.455171 149.243056 
L 45.203862 148.463307 
L 44.903741 148.54477 
L 44.704965 148.965536 
L 44.697455 149.3678 
L 45.33709 151.178024 
L 45.542705 151.528119 
L 46.192987 152.149534 
L 46.621515 152.380322 
L 48.045199 152.083317 
L 48.668351 151.753091 
L 49.246201 151.18395 
L 49.752965 150.390695 
L 50.360491 150.056234 
L 51.090393 150.15336 
L 51.721365 149.972438 
L 52.889997 149.1758 
L 53.610693 148.527978 
L 53.826224 148.649665 
L 54.532685 149.81702 
L 53.410999 150.142782 
L 52.352983 150.677296 
L 49.175219 152.844303 
L 49.101933 155.097251 
L 48.783717 155.004746 
L 48.372707 154.663085 
L 48.037504 154.629693 
L 47.234907 155.04435 
L 47.169388 155.318238 
L 47.202434 155.812273 
L 47.427189 156.612084 
L 48.177461 157.913774 
L 49.133626 159.046109 
L 49.596447 159.409491 
L 50.439441 159.689163 
L 51.810679 160.377093 
L 53.728455 162.565843 
L 56.424143 164.331194 
L 56.952133 164.955533 
L 57.428126 165.302152 
L 58.24914 165.470378 
L 58.842564 164.921484 
L 59.015775 164.140838 
L 58.175113 162.295324 
L 58.333244 161.098791 
L 58.352667 160.068425 
L 57.76529 159.150351 
L 57.89716 156.675496 
L 57.711352 154.327192 
L 57.938276 152.906315 
L 58.694066 152.518717 
L 58.878139 152.242104 
L 58.840366 151.47765 
L 58.230519 148.687614 
L 57.360744 145.764515 
L 57.619572 145.358639 
L 58.293925 145.218125 
L 58.575552 144.566753 
L 58.39271 143.921193 
L 58.04509 143.340468 
L 57.710426 141.551265 
L 57.690701 140.713968 
L 58.001197 137.383799 
L 58.170589 137.138907 
L 59.6034 136.326324 
L 60.298098 135.656269 
L 60.298098 135.656269 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 112.530711 68.417642 
L 112.664373 68.915951 
L 112.943784 69.418477 
L 113.336781 69.504133 
L 113.543305 69.243963 
L 113.397077 68.362675 
L 113.030458 68.232807 
L 112.758797 68.267401 
L 112.530711 68.417642 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 105.223691 55.130069 
L 104.988193 54.929441 
L 104.886652 54.293556 
L 105.019722 53.921881 
L 105.58892 53.783531 
L 106.151896 53.899191 
L 106.314453 54.139242 
L 106.238753 54.600578 
L 105.605457 55.106668 
L 105.223691 55.130069 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 108.475701 69.167281 
L 108.201196 69.08241 
L 107.773774 68.720855 
L 108.487432 68.433278 
L 108.659024 68.480098 
L 109.14856 68.288816 
L 109.632801 68.553853 
L 109.882937 68.792209 
L 110.256132 69.439151 
L 109.067006 69.842854 
L 108.821505 69.559601 
L 108.762894 69.380406 
L 108.475701 69.167281 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 110.103634 53.33488 
L 110.78453 51.661521 
L 111.516586 51.800538 
L 111.878549 52.222133 
L 112.250904 53.213602 
L 112.170482 53.921702 
L 111.352433 54.67669 
L 110.745495 54.961855 
L 110.599646 54.829506 
L 110.470977 54.589436 
L 110.103634 53.33488 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 109.876051 74.552467 
L 109.16839 74.376661 
L 109.115067 74.173578 
L 109.319056 73.46185 
L 109.233731 73.103579 
L 108.976288 72.807805 
L 108.584713 72.124949 
L 108.91919 71.455432 
L 109.218347 71.281287 
L 109.623148 71.536303 
L 110.265358 71.622963 
L 111.337391 71.392953 
L 111.666344 71.839619 
L 111.560492 72.112481 
L 111.780885 72.64539 
L 111.002369 73.949506 
L 110.640137 74.3032 
L 110.471071 74.256616 
L 110.280918 74.272553 
L 109.876051 74.552467 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 115.193834 68.321144 
L 114.837644 67.889146 
L 113.536577 67.072355 
L 113.347024 66.851283 
L 114.249249 65.75842 
L 113.949152 65.421814 
L 114.206662 64.958315 
L 114.538492 64.816973 
L 114.968489 64.978128 
L 116.3298 65.868058 
L 116.877937 66.347846 
L 117.38333 66.654883 
L 117.524097 67.001135 
L 116.47529 68.471812 
L 115.85927 69.132551 
L 115.554329 69.167759 
L 115.193834 68.321144 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 120.240225 63.386251 
L 120.174863 63.198215 
L 120.073322 61.689356 
L 120.78331 61.422659 
L 121.919848 61.791254 
L 122.100181 62.492197 
L 122.050373 63.430051 
L 121.785387 63.619453 
L 121.571586 63.582402 
L 121.309542 63.612096 
L 120.861511 63.832965 
L 120.240225 63.386251 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 74.518598 128.653105 
L 73.529239 127.857669 
L 73.233686 128.019568 
L 73.276044 128.384336 
L 73.773237 129.081542 
L 74.840665 129.636212 
L 75.169274 129.434097 
L 75.186021 128.706237 
L 74.518598 128.653105 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 78.514711 123.726249 
L 77.68743 123.29683 
L 76.962181 123.74644 
L 76.783154 123.932224 
L 76.907402 124.380966 
L 76.452535 124.904161 
L 76.275075 125.840358 
L 76.759312 125.933587 
L 77.42965 124.696371 
L 78.346509 124.301942 
L 79.491957 124.087206 
L 80.013848 122.993456 
L 79.788596 122.865081 
L 79.223108 123.425661 
L 78.514711 123.726249 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 107.428767 78.47498 
L 107.280368 78.378935 
L 106.850952 78.195949 
L 106.209068 78.741554 
L 106.447483 79.917572 
L 106.724513 80.057106 
L 108.051079 80.031431 
L 108.033004 79.773834 
L 107.706934 79.439538 
L 107.428767 78.47498 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 110.622562 78.346831 
L 110.41876 78.197687 
L 110.04807 77.851334 
L 109.120367 78.041189 
L 109.210378 78.886558 
L 109.046864 79.357742 
L 109.04175 80.498878 
L 110.151081 80.324928 
L 110.990247 79.139172 
L 111.62611 78.589057 
L 111.513735 78.487817 
L 111.349072 78.433505 
L 110.939892 78.351231 
L 110.622562 78.346831 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 75.656232 107.109525 
L 76.026012 107.29299 
L 77.601979 105.718486 
L 78.999217 103.564136 
L 78.995245 103.260748 
L 78.351331 103.292318 
L 77.911041 103.796175 
L 77.837841 104.013225 
L 75.656232 107.109525 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 101.70653 55.628347 
L 101.695064 55.833388 
L 101.338926 56.241006 
L 101.552907 56.656618 
L 102.243692 57.707522 
L 102.301141 58.493833 
L 102.949176 59.522999 
L 102.238617 59.951995 
L 102.079808 60.611979 
L 103.107911 61.056769 
L 103.705657 61.110488 
L 103.857951 60.046424 
L 104.551331 60.088361 
L 104.756077 59.860355 
L 104.677572 59.42574 
L 104.409064 58.878836 
L 105.442806 58.731564 
L 106.242671 58.536342 
L 106.210405 57.743264 
L 106.054724 57.300463 
L 105.522249 56.721983 
L 104.868421 56.558988 
L 104.085731 56.193687 
L 104.414221 55.192388 
L 104.259371 54.649341 
L 103.61104 54.548914 
L 102.954612 55.115551 
L 102.539835 55.213103 
L 102.041601 55.021242 
L 101.735807 55.044724 
L 101.70653 55.628347 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 103.257362 63.498699 
L 104.360584 64.837072 
L 105.189534 65.558278 
L 105.054862 65.789986 
L 105.134197 66.354837 
L 105.785216 66.771411 
L 106.456265 66.443217 
L 106.693051 66.201771 
L 106.996543 66.180545 
L 107.338485 66.305567 
L 107.748184 65.418553 
L 108.793161 65.037038 
L 109.723002 65.22368 
L 110.028324 64.98347 
L 110.501917 64.173375 
L 110.757524 63.048086 
L 110.628152 61.007216 
L 110.346918 60.54154 
L 109.896555 60.574271 
L 108.108115 61.076912 
L 106.662243 61.221882 
L 105.973768 61.517903 
L 105.259427 62.788228 
L 103.328305 63.334924 
L 103.257362 63.498699 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 99.097056 70.393119 
L 98.892792 70.132749 
L 98.724882 69.577815 
L 98.198831 69.329161 
L 97.785857 69.421648 
L 97.637592 69.627962 
L 97.661115 69.833177 
L 97.783328 69.975316 
L 97.913653 70.191837 
L 97.825243 70.375796 
L 98.038476 70.528384 
L 98.270838 70.628457 
L 98.80659 70.785882 
L 98.979263 70.665382 
L 99.097056 70.393119 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 107.089431 57.617886 
L 107.630653 58.91701 
L 107.18692 59.239093 
L 107.294029 59.79916 
L 108.647991 60.185786 
L 109.327929 59.758411 
L 110.611414 60.094599 
L 111.32286 59.663634 
L 111.686183 58.993819 
L 111.798455 58.517558 
L 111.283952 58.031745 
L 110.506298 57.632099 
L 110.004762 57.543183 
L 109.297544 57.246219 
L 108.574563 57.145 
L 108.22367 57.208912 
L 107.510187 57.539333 
L 107.193986 57.5551 
L 107.089431 57.617886 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 106.210639 46.019102 
L 106.919574 44.976394 
L 106.874382 44.688308 
L 106.506903 44.222904 
L 106.323685 44.165011 
L 105.999791 44.129366 
L 104.835715 45.508881 
L 104.529554 46.453868 
L 104.688695 46.923567 
L 105.29167 46.350146 
L 105.448089 46.39663 
L 105.649325 46.410054 
L 106.210639 46.019102 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 101.193971 51.004365 
L 100.944202 50.855532 
L 100.487545 50.47143 
L 100.01894 50.515551 
L 99.209805 52.514064 
L 99.407489 52.971292 
L 99.918812 53.380711 
L 100.173132 53.62096 
L 100.312757 53.682869 
L 100.524291 53.715142 
L 100.639779 53.039925 
L 101.193971 51.004365 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 48.269762 117.886827 
L 48.497876 117.038232 
L 47.826332 116.603271 
L 47.302626 116.638094 
L 47.229901 117.031781 
L 47.317436 117.609678 
L 48.269762 117.886827 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 39.026687 145.965376 
L 38.816042 145.545553 
L 38.588497 145.232521 
L 37.936798 144.841918 
L 37.243244 143.993517 
L 36.839207 144.167241 
L 36.631871 143.280052 
L 36.309391 142.941844 
L 35.996306 142.391866 
L 36.089932 141.856538 
L 35.942133 141.496746 
L 35.292469 140.372451 
L 34.714948 139.930643 
L 34.135672 139.832453 
L 34.292461 140.681891 
L 34.675713 141.733511 
L 35.251992 142.529086 
L 35.488721 143.045527 
L 36.673917 145.254902 
L 36.934263 145.49975 
L 37.394697 145.441375 
L 38.089297 145.98082 
L 38.695473 146.653645 
L 39.53085 147.882376 
L 39.912419 147.69691 
L 39.550848 146.788685 
L 39.026687 145.965376 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 140.615577 27.430585 
L 140.920833 27.738275 
L 140.390672 27.914197 
L 140.161694 28.105428 
L 140.358992 28.39301 
L 140.615509 28.40651 
L 141.263869 28.364112 
L 141.864922 27.755562 
L 141.978724 27.338043 
L 142.641777 27.463124 
L 142.781603 27.095024 
L 143.04098 25.214005 
L 142.729916 25.243894 
L 142.212483 25.59746 
L 140.615577 27.430585 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path d="M 124.899506 17.735376 
L 125.334711 18.04807 
L 126.259881 18.511127 
L 126.445988 18.484308 
L 126.778361 18.350333 
L 126.665779 16.327728 
L 126.522794 15.620154 
L 126.341265 15.528264 
L 125.772772 15.315635 
L 125.432291 15.573166 
L 124.92806 16.488535 
L 124.899506 17.735376 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
    <path clip-path="url(#p3cda11393d)" style="fill: none; stroke: #000000"/>
   </g>
   <g id="LineCollection_1">
    <path d="M 72.059495 173.519999 
L 71.461661 171.877461 
L 70.663218 169.683758 
L 69.864611 167.489604 
L 69.065843 165.295007 
L 68.266915 163.099971 
L 67.46783 160.904501 
L 66.668589 158.708605 
L 65.869194 156.512287 
L 65.069649 154.315553 
L 64.269953 152.118408 
L 63.470111 149.920859 
L 62.670123 147.72291 
L 61.869992 145.524569 
L 61.06972 143.325839 
L 60.269308 141.126727 
L 59.46876 138.927238 
L 58.668077 136.727378 
L 57.86726 134.527154 
L 57.066313 132.326569 
L 56.265237 130.125631 
L 55.464034 127.924344 
L 54.662707 125.722715 
L 53.861256 123.520748 
L 53.059686 121.318451 
L 52.257996 119.115827 
L 51.456191 116.912884 
L 50.65427 114.709627 
L 49.852238 112.50606 
L 49.050095 110.302191 
L 48.247844 108.098025 
L 47.445487 105.893567 
L 46.643026 103.688823 
L 45.840463 101.483799 
L 45.0378 99.2785 
L 44.235039 97.072933 
L 43.432182 94.867102 
L 42.629232 92.661014 
L 41.826189 90.454674 
L 41.023058 88.248088 
L 40.219839 86.041261 
L 39.416534 83.8342 
L 38.613146 81.62691 
L 37.809677 79.419396 
L 37.006129 77.211665 
L 36.202503 75.003722 
L 35.398802 72.795573 
L 34.595029 70.587223 
L 33.791184 68.378679 
L 32.987271 66.169945 
L 32.183291 63.961028 
L 31.379246 61.751933 
L 30.575139 59.542667 
L 29.770971 57.333234 
L 28.966745 55.123641 
L 28.162463 52.913893 
L 27.358126 50.703995 
L 26.553737 48.493955 
L 25.749298 46.283776 
L 24.94481 44.073466 
L 24.140277 41.86303 
L 23.3357 39.652473 
L 22.531082 37.441801 
L 21.726423 35.23102 
L 20.921727 33.020136 
L 20.116996 30.809154 
L 19.312231 28.59808 
L 18.507434 26.38692 
L 17.702609 24.17568 
L 16.897756 21.964365 
L 16.092878 19.752981 
L 15.287977 17.541534 
L 14.483055 15.330029 
L 13.678114 13.118472 
L 12.873157 10.906869 
L 12.068184 8.695226 
L 11.523967 7.200001 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
    <path d="M 156.727554 173.52 
L 156.419915 173.15337 
L 154.925906 171.37288 
L 153.431517 169.591936 
L 151.936752 167.810544 
L 150.441614 166.028708 
L 148.946107 164.246432 
L 147.450235 162.463722 
L 145.954002 160.68058 
L 144.457411 158.897013 
L 142.960467 157.113024 
L 141.463173 155.328619 
L 139.965533 153.543801 
L 138.467551 151.758575 
L 136.96923 149.972946 
L 135.470575 148.186919 
L 133.97159 146.400497 
L 132.472277 144.613686 
L 130.972641 142.82649 
L 129.472687 141.038914 
L 127.972416 139.250961 
L 126.471835 137.462638 
L 124.970945 135.673947 
L 123.469752 133.884895 
L 121.968259 132.095485 
L 120.46647 130.305722 
L 118.964388 128.515611 
L 117.462018 126.725156 
L 115.959364 124.934362 
L 114.456428 123.143234 
L 112.953216 121.351775 
L 111.449731 119.559991 
L 109.945976 117.767886 
L 108.441956 115.975465 
L 106.937675 114.182733 
L 105.433136 112.389693 
L 103.928344 110.596351 
L 102.423301 108.802711 
L 100.918013 107.008778 
L 99.412482 105.214557 
L 97.906713 103.420052 
L 96.40071 101.625267 
L 94.894477 99.830208 
L 93.388016 98.034878 
L 91.881333 96.239283 
L 90.374431 94.443427 
L 88.867314 92.647315 
L 87.359986 90.850952 
L 85.852451 89.054341 
L 84.344712 87.257488 
L 82.836774 85.460398 
L 81.328641 83.663074 
L 79.820315 81.865522 
L 78.311802 80.067746 
L 76.803105 78.269751 
L 75.294228 76.471541 
L 73.785175 74.673121 
L 72.275949 72.874497 
L 70.766556 71.075671 
L 69.256997 69.27665 
L 67.747279 67.477437 
L 66.237403 65.678037 
L 64.727375 63.878456 
L 63.217198 62.078697 
L 61.706876 60.278765 
L 60.196413 58.478666 
L 58.685813 56.678402 
L 57.175079 54.87798 
L 55.664217 53.077404 
L 54.153228 51.276679 
L 52.642119 49.475808 
L 51.130891 47.674798 
L 49.61955 45.873652 
L 48.1081 44.072375 
L 46.596543 42.270971 
L 45.084884 40.469447 
L 43.573127 38.667805 
L 42.061276 36.866051 
L 40.549335 35.06419 
L 39.037307 33.262225 
L 37.525197 31.460163 
L 36.013009 29.658007 
L 34.500746 27.855762 
L 32.988412 26.053432 
L 31.476011 24.251023 
L 29.963548 22.44854 
L 28.451025 20.645986 
L 26.938448 18.843366 
L 25.425819 17.040685 
L 23.913143 15.237949 
L 22.400424 13.43516 
L 20.887666 11.632325 
L 19.374872 9.829447 
L 17.862047 8.026532 
L 17.168505 7.200002 
L 17.168504 7.200001 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
    <path d="M 173.519999 91.344896 
L 171.937545 90.431266 
L 169.916236 89.264263 
L 167.894508 88.097018 
L 165.872366 86.929533 
L 163.849813 85.761812 
L 161.826857 84.593858 
L 159.803502 83.425673 
L 157.779753 82.257261 
L 155.755615 81.088624 
L 153.731094 79.919767 
L 151.706195 78.75069 
L 149.680922 77.581399 
L 147.655282 76.411895 
L 145.629279 75.242182 
L 143.602919 74.072262 
L 141.576206 72.902139 
L 139.549146 71.731815 
L 137.521745 70.561294 
L 135.494007 69.390579 
L 133.465937 68.219673 
L 131.437541 67.048578 
L 129.408824 65.877298 
L 127.379792 64.705835 
L 125.350449 63.534193 
L 123.3208 62.362375 
L 121.290852 61.190384 
L 119.260608 60.018222 
L 117.230075 58.845893 
L 115.199257 57.6734 
L 113.168161 56.500746 
L 111.13679 55.327934 
L 109.10515 54.154966 
L 107.073247 52.981846 
L 105.041086 51.808577 
L 103.008672 50.635163 
L 100.97601 49.461605 
L 98.943105 48.287907 
L 96.909963 47.114072 
L 94.876589 45.940103 
L 92.842989 44.766003 
L 90.809166 43.591775 
L 88.775128 42.417422 
L 86.740878 41.242947 
L 84.706423 40.068354 
L 82.671767 38.893645 
L 80.636915 37.718823 
L 78.601874 36.543891 
L 76.566648 35.368853 
L 74.531242 34.193711 
L 72.495662 33.018468 
L 70.459914 31.843128 
L 68.424001 30.667693 
L 66.38793 29.492167 
L 64.351706 28.316553 
L 62.315333 27.140853 
L 60.278818 25.96507 
L 58.242166 24.789208 
L 56.205382 23.61327 
L 54.16847 22.437259 
L 52.131437 21.261177 
L 50.094288 20.085029 
L 48.057028 18.908816 
L 46.019662 17.732542 
L 43.982195 16.55621 
L 41.944633 15.379823 
L 39.906981 14.203384 
L 37.869245 13.026897 
L 35.831429 11.850363 
L 33.793539 10.673787 
L 31.75558 9.497171 
L 29.717557 8.320518 
L 27.776764 7.2 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
    <path d="M 173.52 24.646703 
L 171.526382 24.295175 
L 169.223327 23.889084 
L 166.919854 23.48292 
L 164.615968 23.076682 
L 162.311676 22.670374 
L 160.006983 22.263994 
L 157.701896 21.857545 
L 155.39642 21.451027 
L 153.090562 21.044442 
L 150.784326 20.637791 
L 148.477719 20.231074 
L 146.170748 19.824292 
L 143.863417 19.417448 
L 141.555733 19.010541 
L 139.247702 18.603573 
L 136.93933 18.196544 
L 134.630622 17.789457 
L 132.321585 17.382311 
L 130.012224 16.975109 
L 127.702546 16.56785 
L 125.392557 16.160537 
L 123.082261 15.753169 
L 120.771667 15.345749 
L 118.460778 14.938277 
L 116.149602 14.530754 
L 113.838144 14.123182 
L 111.52641 13.715561 
L 109.214406 13.307892 
L 106.902139 12.900177 
L 104.589613 12.492416 
L 102.276836 12.084611 
L 99.963813 11.676763 
L 97.650549 11.268872 
L 95.337052 10.86094 
L 93.023327 10.452968 
L 90.709379 10.044957 
L 88.395215 9.636907 
L 86.080842 9.228821 
L 83.766264 8.820698 
L 81.451488 8.412541 
L 79.13652 8.004349 
L 76.821365 7.596125 
L 74.57483 7.2 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
   </g>
   <g id="LineCollection_2">
    <path d="M 154.564629 173.519998 
L 155.589648 172.667359 
L 158.25869 170.39954 
L 160.893078 168.091557 
L 163.492207 165.743939 
L 166.055482 163.357225 
L 168.582315 160.931961 
L 171.072125 158.468705 
L 173.519999 155.972516 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
    <path d="M 94.478401 173.519999 
L 96.982345 172.271659 
L 99.652116 170.891539 
L 102.300679 169.471141 
L 104.927424 168.010792 
L 107.53175 166.510827 
L 110.113059 164.971588 
L 112.670759 163.393431 
L 115.204263 161.776716 
L 117.71299 160.121815 
L 120.196364 158.429107 
L 122.653817 156.69898 
L 125.084783 154.931832 
L 127.488706 153.128068 
L 129.865034 151.288101 
L 132.213221 149.412354 
L 134.532729 147.501258 
L 136.823026 145.555249 
L 139.083587 143.574776 
L 141.313893 141.560291 
L 143.513432 139.512258 
L 145.681699 137.431147 
L 147.818198 135.317434 
L 149.922438 133.171604 
L 151.993936 130.99415 
L 154.032218 128.785572 
L 156.036815 126.546376 
L 158.007267 124.277075 
L 159.943124 121.97819 
L 161.84394 119.650249 
L 163.709279 117.293786 
L 165.538714 114.909341 
L 167.331825 112.497462 
L 169.088201 110.058701 
L 170.807438 107.593618 
L 172.489142 105.102779 
L 173.519999 103.53468 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
    <path d="M 7.2 160.830583 
L 9.706786 160.811598 
L 12.212997 160.754649 
L 14.718057 160.659747 
L 17.221393 160.526915 
L 19.72243 160.356184 
L 22.220594 160.147591 
L 24.715313 159.901187 
L 27.206013 159.617026 
L 29.692123 159.295173 
L 32.173074 158.935704 
L 34.648296 158.5387 
L 37.117221 158.104253 
L 39.579283 157.632462 
L 42.033916 157.123434 
L 44.480559 156.577288 
L 46.918649 155.994149 
L 49.347627 155.374149 
L 51.766937 154.717432 
L 54.176022 154.024148 
L 56.574331 153.294456 
L 58.961312 152.528523 
L 61.33642 151.726525 
L 63.699108 150.888647 
L 66.048835 150.01508 
L 68.385061 149.106025 
L 70.707251 148.16169 
L 73.014872 147.182292 
L 75.307395 146.168056 
L 77.584293 145.119214 
L 79.845045 144.036007 
L 82.089131 142.918683 
L 84.316037 141.767499 
L 86.525252 140.582719 
L 88.716269 139.364615 
L 90.888586 138.113465 
L 93.041704 136.829558 
L 95.175129 135.513187 
L 97.288372 134.164655 
L 99.380949 132.784271 
L 101.452378 131.372352 
L 103.502185 129.929221 
L 105.529899 128.45521 
L 107.535056 126.950656 
L 109.517195 125.415906 
L 111.475862 123.85131 
L 113.410607 122.257229 
L 115.320987 120.634027 
L 117.206563 118.982077 
L 119.066902 117.301758 
L 120.901579 115.593455 
L 122.710171 113.857561 
L 124.492265 112.094474 
L 126.247451 110.304597 
L 127.975326 108.488342 
L 129.675495 106.646126 
L 131.347567 104.77837 
L 132.991158 102.885504 
L 134.605892 100.967962 
L 136.191398 99.026183 
L 137.747313 97.060613 
L 139.273279 95.071703 
L 140.768946 93.059909 
L 142.233972 91.025693 
L 143.668019 88.969521 
L 145.07076 86.891866 
L 146.441873 84.793203 
L 147.781042 82.674014 
L 149.087961 80.534786 
L 150.36233 78.376008 
L 151.603856 76.198177 
L 152.812255 74.001792 
L 153.987249 71.787357 
L 155.128569 69.55538 
L 156.235953 67.306372 
L 157.309148 65.04085 
L 158.347906 62.759334 
L 159.351989 60.462347 
L 160.321168 58.150415 
L 161.25522 55.82407 
L 162.15393 53.483844 
L 163.017092 51.130276 
L 163.844509 48.763904 
L 164.635991 46.385271 
L 165.391355 43.994924 
L 166.11043 41.59341 
L 166.793048 39.181281 
L 167.439056 36.75909 
L 168.048303 34.327393 
L 168.62065 31.886747 
L 169.155966 29.437712 
L 169.654128 26.98085 
L 170.115022 24.516725 
L 170.538542 22.045902 
L 170.924591 19.568948 
L 171.27308 17.086431 
L 171.58393 14.598921 
L 171.857068 12.106988 
L 172.092434 9.611204 
L 172.283672 7.2 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
    <path d="M 7.2 127.830595 
L 9.206976 127.815396 
L 11.213491 127.769801 
L 13.219085 127.693821 
L 15.223298 127.587473 
L 17.225671 127.450783 
L 19.225744 127.28378 
L 21.223058 127.086504 
L 23.217155 126.859 
L 25.207578 126.60132 
L 27.193869 126.313523 
L 29.175574 125.995675 
L 31.152237 125.647849 
L 33.123406 125.270125 
L 35.088628 124.862589 
L 37.047451 124.425335 
L 38.999428 123.958463 
L 40.944109 123.462081 
L 42.881049 122.936302 
L 44.809804 122.381247 
L 46.729931 121.797043 
L 48.640989 121.183824 
L 50.542541 120.541731 
L 52.434149 119.870912 
L 54.315381 119.171519 
L 56.185803 118.443714 
L 58.044988 117.687663 
L 59.892509 116.903541 
L 61.727942 116.091526 
L 63.550865 115.251805 
L 65.360861 114.384571 
L 67.157515 113.490023 
L 68.940414 112.568365 
L 70.709149 111.61981 
L 72.463315 110.644575 
L 74.202509 109.642883 
L 75.926332 108.614965 
L 77.634389 107.561056 
L 79.326287 106.481399 
L 81.001639 105.37624 
L 82.660061 104.245833 
L 84.301171 103.090438 
L 85.924594 101.910319 
L 87.529957 100.705748 
L 89.116891 99.477001 
L 90.685033 98.224359 
L 92.234023 96.94811 
L 93.763506 95.648547 
L 95.27313 94.325968 
L 96.76255 92.980676 
L 98.231423 91.612979 
L 99.679413 90.223193 
L 101.106187 88.811635 
L 102.511419 87.378629 
L 103.894786 85.924505 
L 105.25597 84.449595 
L 106.594659 82.954238 
L 107.910546 81.438777 
L 109.20333 79.90356 
L 110.472713 78.348938 
L 111.718405 76.77527 
L 112.940119 75.182914 
L 114.137576 73.572238 
L 115.3105 71.94361 
L 116.458623 70.297404 
L 117.581682 68.633997 
L 118.679418 66.953772 
L 119.751579 65.257113 
L 120.797921 63.544411 
L 121.818202 61.816057 
L 122.812189 60.072448 
L 123.779654 58.313985 
L 124.720375 56.54107 
L 125.634135 54.754111 
L 126.520726 52.953517 
L 127.379943 51.139702 
L 128.211591 49.313081 
L 129.015477 47.474073 
L 129.791418 45.623102 
L 130.539236 43.76059 
L 131.258759 41.886966 
L 131.949821 40.002658 
L 132.612265 38.108101 
L 133.245939 36.203727 
L 133.850697 34.289974 
L 134.4264 32.367281 
L 134.972916 30.43609 
L 135.49012 28.496842 
L 135.977894 26.549984 
L 136.436125 24.595961 
L 136.864708 22.635222 
L 137.263545 20.668216 
L 137.632545 18.695396 
L 137.971622 16.717213 
L 138.280699 14.734121 
L 138.559706 12.746576 
L 138.808577 10.755033 
L 139.027257 8.759949 
L 139.176981 7.200001 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
    <path d="M 7.2 94.762582 
L 8.706135 94.751176 
L 10.211924 94.716959 
L 11.717022 94.65994 
L 13.221084 94.580132 
L 14.723765 94.477552 
L 16.22472 94.352225 
L 17.723604 94.204179 
L 19.220075 94.033449 
L 20.713787 93.840073 
L 22.2044 93.624095 
L 23.69157 93.385566 
L 25.174958 93.12454 
L 26.654221 92.841077 
L 28.129022 92.535242 
L 29.599021 92.207105 
L 31.063882 91.856741 
L 32.523268 91.484231 
L 33.976845 91.08966 
L 35.424279 90.673119 
L 36.865239 90.234703 
L 38.299392 89.774513 
L 39.726412 89.292654 
L 41.145969 88.789237 
L 42.55774 88.264378 
L 43.961398 87.718197 
L 45.356624 87.150819 
L 46.743096 86.562374 
L 48.120496 85.952997 
L 49.488509 85.322829 
L 50.846821 84.672013 
L 52.19512 84.000699 
L 53.533097 83.309041 
L 54.860444 82.597198 
L 56.176858 81.865333 
L 57.482036 81.113613 
L 58.775679 80.342212 
L 60.05749 79.551306 
L 61.327176 78.741077 
L 62.584444 77.91171 
L 63.829006 77.063396 
L 65.060578 76.19633 
L 66.278875 75.31071 
L 67.48362 74.40674 
L 68.674535 73.484626 
L 69.851347 72.544581 
L 71.013787 71.58682 
L 72.161587 70.611563 
L 73.294485 69.619033 
L 74.41222 68.609459 
L 75.514536 67.583071 
L 76.60118 66.540106 
L 77.671903 65.480802 
L 78.726459 64.405403 
L 79.764606 63.314155 
L 80.786107 62.207309 
L 81.790726 61.085118 
L 82.778234 59.94784 
L 83.748404 58.795736 
L 84.701012 57.629071 
L 85.635842 56.448111 
L 86.552677 55.253128 
L 87.451309 54.044396 
L 88.33153 52.822192 
L 89.193139 51.586796 
L 90.035938 50.338493 
L 90.859734 49.077567 
L 91.664338 47.80431 
L 92.449565 46.519012 
L 93.215235 45.221969 
L 93.961173 43.913478 
L 94.687207 42.593839 
L 95.393171 41.263355 
L 96.078902 39.922331 
L 96.744244 38.571076 
L 97.389044 37.209898 
L 98.013154 35.83911 
L 98.616431 34.459027 
L 99.198736 33.069965 
L 99.759935 31.672243 
L 100.299901 30.266181 
L 100.818509 28.852103 
L 101.31564 27.430332 
L 101.791181 26.001195 
L 102.245021 24.565019 
L 102.677058 23.122134 
L 103.087191 21.672871 
L 103.475327 20.217563 
L 103.841377 18.756543 
L 104.185256 17.290146 
L 104.506886 15.818709 
L 104.806194 14.34257 
L 105.083109 12.862067 
L 105.33757 11.377539 
L 105.569517 9.889328 
L 105.778897 8.397775 
L 105.930405 7.2 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
    <path d="M 7.2 61.643475 
L 8.20452 61.635867 
L 9.20881 61.613046 
L 10.212639 61.575017 
L 11.215777 61.521789 
L 12.217994 61.453373 
L 13.219059 61.369786 
L 14.218744 61.271047 
L 15.216818 61.157177 
L 16.213054 61.028205 
L 17.207221 60.884158 
L 18.199093 60.725071 
L 19.188442 60.550979 
L 20.175041 60.361922 
L 21.158663 60.157945 
L 22.139082 59.939093 
L 23.116075 59.705417 
L 24.089416 59.45697 
L 25.058883 59.19381 
L 26.024253 58.915997 
L 26.985304 58.623594 
L 27.941816 58.31667 
L 28.89357 57.995293 
L 29.840348 57.659538 
L 30.781931 57.309482 
L 31.718105 56.945205 
L 32.648654 56.56679 
L 33.573365 56.174325 
L 34.492026 55.7679 
L 35.404425 55.347608 
L 36.310355 54.913545 
L 37.209606 54.46581 
L 38.101973 54.004507 
L 38.98725 53.529742 
L 39.865236 53.041622 
L 40.735728 52.540261 
L 41.598526 52.025773 
L 42.453433 51.498277 
L 43.300253 50.957892 
L 44.138791 50.404744 
L 44.968855 49.838959 
L 45.790254 49.260667 
L 46.602801 48.670001 
L 47.406308 48.067095 
L 48.200592 47.452089 
L 48.98547 46.825124 
L 49.760762 46.186343 
L 50.52629 45.535893 
L 51.281879 44.873923 
L 52.027355 44.200585 
L 52.762547 43.516033 
L 53.487287 42.820425 
L 54.201409 42.113919 
L 54.904748 41.396679 
L 55.597143 40.668869 
L 56.278435 39.930655 
L 56.948468 39.182207 
L 57.607089 38.423697 
L 58.254146 37.655298 
L 58.889491 36.877188 
L 59.512977 36.089544 
L 60.124463 35.292547 
L 60.723808 34.48638 
L 61.310873 33.671228 
L 61.885526 32.847278 
L 62.447633 32.014719 
L 62.997065 31.173742 
L 63.533698 30.32454 
L 64.057407 29.467307 
L 64.568073 28.602241 
L 65.065578 27.729539 
L 65.549808 26.849403 
L 66.020652 25.962034 
L 66.478002 25.067635 
L 66.921754 24.166411 
L 67.351805 23.25857 
L 67.768056 22.34432 
L 68.170413 21.42387 
L 68.558783 20.497432 
L 68.933076 19.565218 
L 69.293208 18.627442 
L 69.639095 17.684319 
L 69.970658 16.736065 
L 70.287821 15.782898 
L 70.590511 14.825037 
L 70.878658 13.862702 
L 71.152198 12.896112 
L 71.411066 11.925491 
L 71.655204 10.95106 
L 71.884555 9.973043 
L 72.099067 8.991665 
L 72.298691 8.00715 
L 72.450815 7.200001 
L 72.450815 7.2 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
    <path d="M 7.2 28.490268 
L 7.702389 28.486463 
L 8.204663 28.47505 
L 8.706707 28.45603 
L 9.208405 28.429409 
L 9.709642 28.395192 
L 10.210304 28.353388 
L 10.710275 28.304006 
L 11.20944 28.247057 
L 11.707686 28.182554 
L 12.204898 28.110512 
L 12.700961 28.030947 
L 13.195763 27.943879 
L 13.689189 27.849327 
L 14.181127 27.747312 
L 14.671463 27.637857 
L 15.160084 27.520989 
L 15.64688 27.396734 
L 16.131738 27.26512 
L 16.614547 27.126178 
L 17.095197 26.979939 
L 17.573576 26.826437 
L 18.049575 26.665707 
L 18.523086 26.497787 
L 18.993999 26.322714 
L 19.462206 26.140528 
L 19.9276 25.951273 
L 20.390075 25.75499 
L 20.849523 25.551725 
L 21.30584 25.341525 
L 21.758921 25.124437 
L 22.208663 24.900512 
L 22.654961 24.669801 
L 23.097714 24.432358 
L 23.536819 24.188235 
L 23.972177 23.93749 
L 24.403687 23.68018 
L 24.831251 23.416364 
L 25.25477 23.146102 
L 25.674146 22.869457 
L 26.089285 22.586492 
L 26.500091 22.297271 
L 26.906468 22.001862 
L 27.308325 21.700332 
L 27.705569 21.39275 
L 28.098109 21.079186 
L 28.485855 20.759714 
L 28.868718 20.434405 
L 29.246609 20.103335 
L 29.619443 19.766579 
L 29.987134 19.424215 
L 30.349597 19.076322 
L 30.70675 18.722978 
L 31.058509 18.364266 
L 31.404796 18.000267 
L 31.74553 17.631065 
L 32.080633 17.256745 
L 32.410028 16.877392 
L 32.733639 16.493094 
L 33.051393 16.103939 
L 33.363217 15.710016 
L 33.669039 15.311415 
L 33.968788 14.908227 
L 34.262396 14.500547 
L 34.549796 14.088466 
L 34.830922 13.672079 
L 35.105709 13.251482 
L 35.374094 12.826772 
L 35.636016 12.398045 
L 35.891415 11.965401 
L 36.140231 11.528938 
L 36.382409 11.088757 
L 36.617891 10.644958 
L 36.846625 10.197643 
L 37.068558 9.746916 
L 37.283639 9.292879 
L 37.491818 8.835636 
L 37.693048 8.375293 
L 37.887283 7.911954 
L 38.074478 7.445727 
L 38.16986 7.2 
" clip-path="url(#p3cda11393d)" style="fill: none; stroke: #b0b0b0; stroke-width: 0.8"/>
   </g>
   <g id="patch_3">
    <path d="M 7.2 173.52 
L 7.2 7.2 
L 173.52 7.2 
L 173.52 173.52 
L 7.2 173.52 
z
" style="fill: none; stroke: #000000; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square"/>
   </g>
  </g>
 </g>
 <defs>
  <clipPath id="p3cda11393d">
   <path d="M 7.2 173.52 
L 7.2 7.2 
L 173.52 7.2 
L 173.52 173.52 
L 7.2 173.52 
"/>
  </clipPath>
 </defs>
</svg>
<pre>&lt;pyresample.utils.cartopy.Projection object at 0x7e8c0497e660&gt;</pre></div></div>
</div>
</section>
</section>
<section id="devalgo-test-scene-1-radiometric-scene">
<h2>DEVALGO test scene 1 - Radiometric scene<a class="headerlink" href="#devalgo-test-scene-1-radiometric-scene" title="Link to this heading">#</a></h2>
<p>Now we can plot the image of the retrieved parameters, here we chose the sea ice concentration, i.e., index 6. The image is shown in <a class="reference internal" href="#scene1-sic-forward"><span class="std std-numref">Fig. 9</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">scene1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scene1</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">outsic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OEM</span><span class="o">.</span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">scene1</span><span class="o">.</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="n">scene1</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">scene1</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lea</span><span class="p">)</span>
<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">))</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="c">#outsic[landmask] .= NaN</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">outsic</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Retrieved SIC on Scene 1 for the forward scan direction.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scene1_sic_forward&quot;</span><span class="p">)</span>

<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="scene1-sic-forward">
<img alt="_images/figure_scene1_sic_forward.png" src="_images/figure_scene1_sic_forward.png" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Retrieved SIC on Scene 1 for the forward scan direction.</span><a class="headerlink" href="#scene1-sic-forward" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<section id="overview-of-surface-classes-and-true-brightness-temperatures">
<h3>Overview of surface classes and true brightness temperatures<a class="headerlink" href="#overview-of-surface-classes-and-true-brightness-temperatures" title="Link to this heading">#</a></h3>
<p>For the interpretation of the retrieval results, we can also plot the surface classes. The surface classes were defined in the DEVALGO test cards and were input to several forward models to generate brightness temperatures.</p>
<p>The data for the surface classes is stored in the test scene files. For comparison we can plot the retrieved data on the original input brightness temperature before the CIMR satellite simulator. For test scenes 1 and 2, the helper function <code class="docutils literal notranslate"><span class="pre">read_testscene</span></code> can be used. It reads the data from the test scenes and returns the brightness temperatures and the pyresample area definition and the image extent. The data block is also a 2d array with the dimensions (n, 10), where n is the number of data points, and 10 is the number of channels. This is to be able to use the same retrieval function for this dataset. The number of data points n is here 1400*1400, i.e., the total number of pixels in the test scene. The area definition is the EASE2 North grid in 1 km resolution. The image extent is the extent of the image in the projection coordinates. This is needed to plot the data on the map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">testinput</span><span class="p">,</span><span class="w"> </span><span class="n">mea</span><span class="p">,</span><span class="w"> </span><span class="n">imextent</span><span class="p">,</span><span class="w"> </span><span class="n">surfaces</span><span class="o">=</span><span class="n">read_testscene</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scene1</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>

<span class="k">let</span><span class="w"> </span>
<span class="w">    </span><span class="n">surface_names</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;first year seaice&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;multi year seaice&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;snow on land&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;land without snow&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;ocean sss=34 SST=275&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;ocean SSS=6 SST=275&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;ocean SSS=6 SST=285&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;ocean SSS=34 SST=285&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;RFI (5000K)&quot;</span><span class="p">]</span>

<span class="w">    </span><span class="n">cmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&quot;viridis&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span>

<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">surfaces</span><span class="p">[</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">imextent</span><span class="p">,</span><span class="w"> </span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s">&quot;nearest&quot;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">9.5</span><span class="p">)</span>

<span class="w">    </span><span class="n">cbar_ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04</span><span class="p">,</span><span class="w"> </span><span class="mf">0.65</span><span class="p">])</span>

<span class="w">    </span><span class="n">cbar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="w"> </span><span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span><span class="w"> </span><span class="n">ticks</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;vertical&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="c">#now only show the range 0.5 to 9.5 area of the colorbar, so the surface names are centered for each color and there is no unused color</span>
<span class="w">    </span><span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="mi">9</span><span class="p">)</span>
<span class="w">    </span><span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">surface_names</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Illustration of surface types for scene 1.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scene1_surfaces&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="scene1-surfaces">
<img alt="_images/figure_scene1_surfaces.png" src="_images/figure_scene1_surfaces.png" />
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Illustration of surface types for scene 1.</span><a class="headerlink" href="#scene1-surfaces" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>We can plot all retrieved parameters in a single plot. We chose to define the plotting in a function, to reuse it for the backward scan and the other scenes.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    plot_all_params(dat, x, y, swath=true,mask=true,errors=false)</span>

<span class="s">Plot all parameters from the OEM output in a 3x3 grid.</span>
<span class="s">parameter:</span>
<span class="s">* dat: the output of the OEM algorithm (or error)</span>
<span class="s">* swath: if true, plot the data as a scatter plot, if false, project the data </span>
<span class="s">to the EASE2 grid and plot as an image</span>
<span class="s">* mask: if true, mask the data according to the sea ice concentration</span>
<span class="s">* errors: if :true (or :std or stderr), plot the error data instead of the data, changing the color scale, limits, etc. accordingly</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">direction</span><span class="p">;</span><span class="w"> </span><span class="n">swath</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:false</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">direction</span><span class="o">==</span><span class="s">&quot;combined&quot;</span>
<span class="w">        </span><span class="n">ldata</span><span class="o">=</span><span class="w"> </span><span class="k">let</span><span class="w"> </span><span class="n">dat</span><span class="o">=</span><span class="n">vcat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dat</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dat</span><span class="p">),</span>
<span class="w">             </span><span class="n">x</span><span class="o">=</span><span class="n">vcat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">vcat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">),</span><span class="n">lat</span><span class="o">=</span><span class="n">vcat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">),</span><span class="n">lon</span><span class="o">=</span><span class="n">vcat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lon</span><span class="p">),</span><span class="n">errr</span><span class="o">=</span><span class="n">vcat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">errr</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">errr</span><span class="p">),</span><span class="n">its</span><span class="o">=</span><span class="n">vcat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">its</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">its</span><span class="p">)</span>
<span class="w">            </span><span class="p">(;</span><span class="n">dat</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">errr</span><span class="p">,</span><span class="n">its</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">deepcopy</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">ldata</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">deepcopy</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span>
<span class="w">    </span><span class="n">lealons</span><span class="p">,</span><span class="n">lealats</span><span class="o">=</span><span class="n">lea</span><span class="o">.</span><span class="n">get_lonlats</span><span class="p">()</span>
<span class="w">    </span><span class="n">landmask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basemap</span><span class="o">.</span><span class="n">maskoceans</span><span class="p">(</span><span class="n">lealons</span><span class="p">,</span><span class="n">lealats</span><span class="p">,</span><span class="n">lealats</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s">&quot;i&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mask</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">PyArray</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Array</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;.~</span><span class="n">x</span><span class="w"> </span>

<span class="w">    </span><span class="n">ccrs</span><span class="o">=</span><span class="n">lea</span><span class="o">.</span><span class="n">to_cartopy_crs</span><span class="p">()</span>


<span class="w">    </span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">],</span><span class="w"> </span><span class="n">subplot_kw</span><span class="o">=</span><span class="n">PyDict</span><span class="p">(</span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;projection&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ccrs</span><span class="p">)))</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyconvert</span><span class="p">(</span><span class="kt">Array</span><span class="p">,</span><span class="w"> </span><span class="n">ax</span><span class="p">)</span>
<span class="w">    </span><span class="n">x</span><span class="o">=</span><span class="n">ldata</span><span class="o">.</span><span class="n">x</span>
<span class="w">    </span><span class="n">y</span><span class="o">=</span><span class="n">ldata</span><span class="o">.</span><span class="n">y</span>
<span class="w">    </span><span class="n">lat</span><span class="o">=</span><span class="n">ldata</span><span class="o">.</span><span class="n">lat</span>
<span class="w">    </span><span class="n">lon</span><span class="o">=</span><span class="n">ldata</span><span class="o">.</span><span class="n">lon</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="ss">:true</span><span class="p">,</span><span class="ss">:std</span><span class="p">,</span><span class="ss">:stderr</span><span class="p">)</span>
<span class="w">        </span><span class="n">dat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ldata</span><span class="o">.</span><span class="n">errr</span>
<span class="w">        </span><span class="n">mins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span>
<span class="w">        </span><span class="c">#maxs = [10, 10, 0.5, 10, 10, 0.3, 0.3, 100, 5]</span>
<span class="w">        </span><span class="n">maxs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diag</span><span class="p">(</span><span class="n">sqrt</span><span class="o">.</span><span class="p">(</span><span class="n">OEM</span><span class="o">.</span><span class="n">S_p</span><span class="p">))</span><span class="o">&#39;</span>

<span class="w">        </span><span class="n">labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;wind speed error [m/s]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;total water vapor error [kg/m²]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cloud liquid water error [kg/m²]&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;sea surface temperature error [K]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ice surface temperature error [K]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sea ice concentration error [1]&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;multi year ice fraction error [1]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;first year ice thickness error [cm]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sea surface salinity error [ppt]&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="k">elseif</span><span class="w"> </span><span class="n">errors</span><span class="o">==</span><span class="ss">:ratio</span>
<span class="w">        </span><span class="n">dat</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="mf">1.0</span><span class="w"> </span><span class="o">.-</span><span class="w"> </span><span class="p">(</span><span class="n">ldata</span><span class="o">.</span><span class="n">errr</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="n">diag</span><span class="p">(</span><span class="n">sqrt</span><span class="o">.</span><span class="p">(</span><span class="n">OEM</span><span class="o">.</span><span class="n">S_p</span><span class="p">))</span><span class="o">&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">mins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="w">        </span><span class="n">maxs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="w">        </span><span class="n">labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;wind speed uncertainty ratio&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;total water vapor uncertainty ratio&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cloud liquid water uncertainty ratio&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;sea surface temperature uncertainty ratio&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ice surface temperature uncertainty ratio&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sea ice concentration uncertainty ratio&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;multi year ice fraction uncertainty ratio&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;first year ice thickness uncertainty ratio&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sea surface salinity uncertainty ratio&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="k">elseif</span><span class="w"> </span><span class="n">errors</span><span class="o">==</span><span class="ss">:false</span><span class="w">    </span>
<span class="w">        </span><span class="n">dat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ldata</span><span class="o">.</span><span class="n">dat</span>
<span class="w">        </span><span class="n">mins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">250</span><span class="p">,</span><span class="w"> </span><span class="mi">250</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">]</span>
<span class="w">        </span><span class="n">maxs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">280</span><span class="p">,</span><span class="w"> </span><span class="mi">280</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">]</span>
<span class="w">        </span><span class="n">labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;wind speed [m/s]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;total water vapor [kg/m²]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cloud liquid water [kg/m²]&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;sea surface temperature [K]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ice surface temperature [K]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sea ice concentration [1]&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;multi year ice fraction [1]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;first year ice thickness [cm]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sea surface salinity [ppt]&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">cm</span><span class="o">=</span><span class="n">pyplot</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span>
<span class="w">    </span><span class="n">cm</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="s">&quot;grey&quot;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">if</span><span class="w"> </span><span class="o">:</span><span class="n">sic</span><span class="w"> </span><span class="o">∈</span><span class="w"> </span><span class="n">mask</span>
<span class="w">        </span><span class="n">sic</span><span class="o">=</span><span class="n">ldata</span><span class="o">.</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="c">#sea ice concentration from original data input, independent if errors is set or not</span>
<span class="w">        </span><span class="n">dat</span><span class="p">[</span><span class="n">sic</span><span class="o">.&gt;</span><span class="mf">0.9</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">        </span><span class="n">dat</span><span class="p">[</span><span class="n">sic</span><span class="o">.&gt;</span><span class="mf">0.9</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">        </span><span class="n">dat</span><span class="p">[</span><span class="n">sic</span><span class="o">.&lt;</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">        </span><span class="n">dat</span><span class="p">[</span><span class="n">sic</span><span class="o">.&lt;</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">        </span><span class="n">dat</span><span class="p">[</span><span class="n">sic</span><span class="o">.&lt;</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">        </span><span class="n">dat</span><span class="p">[</span><span class="n">sic</span><span class="o">.&gt;</span><span class="mf">0.9</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">9</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">swath</span>
<span class="w">            </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">s</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="n">mins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">maxs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="n">cimg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lea</span><span class="p">)</span>
<span class="w">            </span><span class="n">cimg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">cimg</span><span class="p">,</span><span class="w"> </span><span class="mi">1400</span><span class="p">,</span><span class="w"> </span><span class="mi">1400</span><span class="p">)</span>
<span class="w">            </span><span class="n">leaextent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">lea</span><span class="o">.</span><span class="n">area_extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="w">            </span><span class="n">if</span><span class="w"> </span><span class="o">:</span><span class="n">land</span><span class="w"> </span><span class="o">∈</span><span class="w"> </span><span class="n">mask</span>
<span class="w">                </span><span class="n">cimg</span><span class="p">[</span><span class="n">landmask</span><span class="p">]</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="nb">NaN</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cimg</span><span class="p">,</span><span class="w"> </span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="n">mins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">maxs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">origin</span><span class="o">=</span><span class="s">&quot;upper&quot;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="p">)</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">labs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">        </span><span class="n">cb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;vertical&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="w">        </span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">save!</span><span class="o">=</span><span class="nb">false</span>
<span class="w">        </span><span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s">&quot;tight&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">fig</span>
<span class="k">end</span>
</pre></div>
</div>
</section>
<section id="retrieval-before-and-after-the-satellite-simulator-for-the-radiometric-scene">
<h3>Retrieval before and after the satellite simulator for the radiometric scene<a class="headerlink" href="#retrieval-before-and-after-the-satellite-simulator-for-the-radiometric-scene" title="Link to this heading">#</a></h3>
<p>Plotting the results resampled to the surface grid 1 km EASE2 North in <a class="reference internal" href="#scene1-params-forward"><span class="std std-numref">Fig. 11</span></a>. The scan lines are barely visible. In this plot the sea ice concentration defines the mask for the other parameters. Wind speed, sea surface temperature and sea surface salinity are shown for small sea ice concentrations while ice surface temperature, sea ice thickness and multi year ice fraction are shown only for higher sea ice concentrations. The total water vapor and cloud liquid water are shown for all sea ice concentrations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;forward&quot;</span>
<span class="w">    </span><span class="n">fig</span><span class="o">=</span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">scene1</span><span class="p">,</span><span class="n">dir</span><span class="p">,</span><span class="n">swath</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:false</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Retrieved parameters for scene 1 in the forward scan direction.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scene1_params_forward&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="scene1-params-forward">
<img alt="_images/figure_scene1_params_forward.png" src="_images/figure_scene1_params_forward.png" />
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Retrieved parameters for scene 1 in the forward scan direction.</span><a class="headerlink" href="#scene1-params-forward" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Despite the forward model not including land surfaces, the retrieval is also run over the land surfaces brightness temperatures, since they are similar to the sea ice brightness temperatures.</p>
<p>The uncertainties are the square root of the diagonal of the error covariance for the retrieved state and are displayed in <a class="reference internal" href="#scene1-params-forward-errors"><span class="std std-numref">Fig. 12</span></a>. From the uncertainties it can be seen that the forward model is not really able to reproduce the brightness temperatures over land surfaces. The uncertainties are very high for the land surfaces, in particular in the cloud liquid water and total water vapor retrieval. The sea ice concentration shows the lowest uncertainties as the sensitivity of the forward model is highest for this parameter. For multi year ice areas which are also retrieved as high multi year ice fraction, the uncertainty of the first year ice thickness retrieval is high as there is little first year ice present.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;forward&quot;</span>
<span class="w">    </span><span class="n">fig</span><span class="o">=</span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">scene1</span><span class="p">,</span><span class="n">dir</span><span class="p">,</span><span class="n">swath</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:std</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Uncertainty after the retrieval for scene 1 in the forward scan direction.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scene1_params_forward_errors&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="scene1-params-forward-errors">
<img alt="_images/figure_scene1_params_forward_errors.png" src="_images/figure_scene1_params_forward_errors.png" />
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Uncertainty after the retrieval for scene 1 in the forward scan direction.</span><a class="headerlink" href="#scene1-params-forward-errors" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>In addition to the uncertainty of the retrieval in this Bayesian method, the gained knowledge of the parameters can be assessed. In <a class="reference internal" href="#scene1-params-forward-errors-ratio"><span class="std std-numref">Fig. 13</span></a> we use the 1-uncertainty ratio as a measure of how much our knowledge of each parameter is improved by doing the retrieval, compared to prior knowledge.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The 1-uncertainty ratio (in words: one minus uncertainty ratio) is calculated as the ratio of the prior uncertainty to the posterior uncertainty. A value of 0 means that the retrieval did not improve the knowledge of the parameter, a value of 1 means that the retrieval greatly improved the knowledge of the parameter. As a consequence, this gain in knowledge depends strongly on the prior knowledge of the parameter.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;forward&quot;</span>
<span class="w">    </span><span class="n">fig</span><span class="o">=</span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">scene1</span><span class="p">,</span><span class="n">dir</span><span class="p">,</span><span class="n">swath</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:ratio</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;One minus uncertainty ratio before and after th eretrieval for scene 1 in the forward scan direction. 0 means no knowledge improvement, 1 means large knowlege improvement.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scene1_params_forward_errors_ratio&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="scene1-params-forward-errors-ratio">
<img alt="_images/figure_scene1_params_forward_errors_ratio.png" src="_images/figure_scene1_params_forward_errors_ratio.png" />
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">One minus uncertainty ratio before and after th eretrieval for scene 1 in the forward scan direction. 0 means no knowledge improvement, 1 means large knowlege improvement.</span><a class="headerlink" href="#scene1-params-forward-errors-ratio" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>We also apply the retrieval directly to the input data now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">gdata1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">let</span>
<span class="w">    </span><span class="n">tdat</span><span class="p">,</span><span class="n">terr</span><span class="p">,</span><span class="n">tres</span><span class="o">=</span><span class="n">run_oem</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">testinput</span><span class="p">))</span>
<span class="w">    </span><span class="kt">NamedTuple</span><span class="p">{(</span><span class="ss">:ws</span><span class="p">,</span><span class="w"> </span><span class="ss">:twv</span><span class="p">,</span><span class="w"> </span><span class="ss">:clw</span><span class="p">,</span><span class="w"> </span><span class="ss">:sst</span><span class="p">,</span><span class="w"> </span><span class="ss">:ist</span><span class="p">,</span><span class="w"> </span><span class="ss">:sic</span><span class="p">,</span><span class="w"> </span><span class="ss">:myi</span><span class="p">,</span><span class="w"> </span><span class="ss">:sit</span><span class="p">,</span><span class="w"> </span><span class="ss">:sss</span><span class="p">)}(</span><span class="n">reshape</span><span class="p">(</span><span class="n">tdat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="mi">1400</span><span class="p">,</span><span class="mi">1400</span><span class="p">)[</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">9</span><span class="p">)</span>
<span class="k">end</span>
<span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>Now we are comparing the retrieved sea ice concentration from the CIMR L1b simulated data to the sea ice concentration retrieved from the input data (to the simulator) in <a class="reference internal" href="#scene1-sic-comparison"><span class="std std-numref">Fig. 14</span></a>. The difference is very small, which is expected as the simulator is only modifying the input brightness temperature according to the CIMR instrument geometry. The difference is only visible at the ice edges and at the intermediate ice concentration where slight scan pattern are visible from the simulated L1b data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">scene1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scene1</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">))</span>

<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;SIC on CIMR input, scene 1&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gdata1</span><span class="o">.</span><span class="n">sic</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="n">imextent</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">outsic</span><span class="o">=</span><span class="n">OEM</span><span class="o">.</span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">scene1</span><span class="o">.</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">scene1</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="n">scene1</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span><span class="n">lea</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;SIC on CIMR output, scene 1&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">outsic</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;difference&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">outsic</span><span class="o">.-</span><span class="n">gdata1</span><span class="o">.</span><span class="n">sic</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">&quot;RdBu_r&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Comparison of SIC on CIMR input and output brightness temperatures for scene 1 in forward direction&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scene1_sic_comparison&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="scene1-sic-comparison">
<img alt="_images/figure_scene1_sic_comparison.png" src="_images/figure_scene1_sic_comparison.png" />
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Comparison of SIC on CIMR input and output brightness temperatures for scene 1 in forward direction</span><a class="headerlink" href="#scene1-sic-comparison" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="performance-metrics-for-the-radiometric-scene">
<h3>Performance metrics for the radiometric scene<a class="headerlink" href="#performance-metrics-for-the-radiometric-scene" title="Link to this heading">#</a></h3>
<p>Now we can also calculate the difference between all parameters of the retrieval from the L1b data and the input data. For this we define a helper function to calculate the difference between the retrieval on the input TB and L1b simulation output. Little differences are expected originating only from the satellite simulator edge effects.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">calculate_overall_performance(scenes,gdatas,scene_labels,borders)</span>
<span class="s">calculates the overall performance of several scenes and returns an array of values. If direction is set to &quot;combined&quot; it combines the forward and backward retrieval during the reprojection.</span>
<span class="s">scenes is just a array of scenes, gdatas is an array of the truths for corresponding to the scenes</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">calculate_overall_performances</span><span class="p">(</span><span class="n">scenes</span><span class="p">,</span><span class="n">gdatas</span><span class="p">,</span><span class="n">directions</span><span class="p">,</span><span class="n">borders</span><span class="p">)</span>
<span class="w">    </span><span class="n">thevars</span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;ws&quot;</span><span class="p">,</span><span class="s">&quot;twv&quot;</span><span class="p">,</span><span class="s">&quot;clw&quot;</span><span class="p">,</span><span class="s">&quot;sst&quot;</span><span class="p">,</span><span class="s">&quot;ist&quot;</span><span class="p">,</span><span class="s">&quot;sic&quot;</span><span class="p">,</span><span class="s">&quot;myi&quot;</span><span class="p">,</span><span class="s">&quot;sit&quot;</span><span class="p">,</span><span class="s">&quot;sss&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">directions</span><span class="w"> </span>
<span class="w">        </span><span class="nd">@assert</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">,</span><span class="s">&quot;combined&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">scenes</span><span class="p">)</span><span class="o">==</span><span class="n">length</span><span class="p">(</span><span class="n">gdatas</span><span class="p">)</span><span class="o">==</span><span class="n">length</span><span class="p">(</span><span class="n">borders</span><span class="p">)</span>
<span class="w">    </span><span class="n">results</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">()</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">axes</span><span class="p">(</span><span class="n">thevars</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">results</span><span class="p">[</span><span class="n">thevars</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">()</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">directions</span>
<span class="w">            </span><span class="n">diffs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">            </span><span class="n">truthes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">axes</span><span class="p">(</span><span class="n">scenes</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">direction</span><span class="o">==</span><span class="s">&quot;combined&quot;</span>
<span class="w">                    </span><span class="n">cimg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">project_data_to_area_nn</span><span class="p">([</span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">];</span><span class="w"> </span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">j</span><span class="p">]],</span><span class="w"> </span><span class="p">[</span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">;</span><span class="w"> </span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lon</span><span class="p">;</span><span class="w"> </span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lon</span><span class="p">],</span><span class="w"> </span><span class="n">lea</span><span class="p">)</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                    </span><span class="n">cimg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">],</span><span class="w"> </span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lea</span><span class="p">)</span>
<span class="w">                </span><span class="k">end</span>
<span class="w">                </span><span class="n">cimg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">cimg</span><span class="p">,</span><span class="w"> </span><span class="mi">1400</span><span class="p">,</span><span class="w"> </span><span class="mi">1400</span><span class="p">)</span>
<span class="w">                </span><span class="n">cimg_ref</span><span class="o">=</span><span class="n">gdatas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="kt">Symbol</span><span class="p">(</span><span class="n">thevars</span><span class="p">[</span><span class="n">j</span><span class="p">])][</span><span class="o">:</span><span class="p">]</span>
<span class="w">                </span><span class="n">cimg_ref</span><span class="o">=</span><span class="n">reshape</span><span class="p">(</span><span class="n">cimg_ref</span><span class="p">,</span><span class="mi">1400</span><span class="p">,</span><span class="mi">1400</span><span class="p">)</span>
<span class="w">                </span><span class="n">diff</span><span class="o">=</span><span class="n">cimg</span><span class="o">.-</span><span class="n">cimg_ref</span>
<span class="w">                </span>
<span class="w">                </span><span class="n">diff</span><span class="o">=</span><span class="n">diff</span><span class="p">[</span><span class="n">borders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="n">borders</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">borders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="n">borders</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="o">:</span><span class="p">]</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="n">isnan</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="w">                </span><span class="n">push!</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span><span class="n">diff</span><span class="p">)</span>
<span class="w">                </span><span class="n">push!</span><span class="p">(</span><span class="n">truthes</span><span class="p">,</span><span class="n">cimg_ref</span><span class="p">[</span><span class="n">borders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="n">borders</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">borders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="n">borders</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="o">:</span><span class="p">]</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="n">isnan</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="n">results</span><span class="p">[</span><span class="n">thevars</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="n">direction</span><span class="p">]</span><span class="o">=</span><span class="p">(;</span><span class="n">meanvalue</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="n">vcat</span><span class="p">(</span><span class="n">truthes</span><span class="o">...</span><span class="p">)),</span><span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="n">vcat</span><span class="p">(</span><span class="n">diffs</span><span class="o">...</span><span class="p">)),</span><span class="n">std</span><span class="o">=</span><span class="n">std</span><span class="p">(</span><span class="n">vcat</span><span class="p">(</span><span class="n">diffs</span><span class="o">...</span><span class="p">)))</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">results</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">markdown_table</span><span class="p">(</span><span class="n">results</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">label</span><span class="p">;</span><span class="n">include_mean</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">show_units</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">thevars</span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;ws&quot;</span><span class="p">,</span><span class="s">&quot;twv&quot;</span><span class="p">,</span><span class="s">&quot;clw&quot;</span><span class="p">,</span><span class="s">&quot;sst&quot;</span><span class="p">,</span><span class="s">&quot;ist&quot;</span><span class="p">,</span><span class="s">&quot;sic&quot;</span><span class="p">,</span><span class="s">&quot;myi&quot;</span><span class="p">,</span><span class="s">&quot;sit&quot;</span><span class="p">,</span><span class="s">&quot;sss&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">units</span><span class="o">=</span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;ws&quot;</span><span class="o">=&gt;</span><span class="s">&quot;m/s&quot;</span><span class="p">,</span><span class="s">&quot;twv&quot;</span><span class="o">=&gt;</span><span class="s">&quot;kg/m²&quot;</span><span class="p">,</span><span class="s">&quot;clw&quot;</span><span class="o">=&gt;</span><span class="s">&quot;kg/m²&quot;</span><span class="p">,</span><span class="s">&quot;sst&quot;</span><span class="o">=&gt;</span><span class="s">&quot;K&quot;</span><span class="p">,</span><span class="s">&quot;ist&quot;</span><span class="o">=&gt;</span><span class="s">&quot;K&quot;</span><span class="p">,</span><span class="s">&quot;sic&quot;</span><span class="o">=&gt;</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;myi&quot;</span><span class="o">=&gt;</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;sit&quot;</span><span class="o">=&gt;</span><span class="s">&quot;cm&quot;</span><span class="p">,</span><span class="s">&quot;sss&quot;</span><span class="o">=&gt;</span><span class="s">&quot;ppt&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="c">#create markdown table, MyST markdown if in jupyter book compilation, normal otherwise</span>
<span class="w">    </span><span class="n">outstring</span><span class="o">=</span><span class="s">&quot;```{list-table} Performance metric for </span><span class="si">$title</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">    </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="s">&quot;:name: </span><span class="se">\&quot;</span><span class="s">performance-</span><span class="si">$label</span><span class="se">\&quot;\n</span><span class="s">&quot;</span>
<span class="w">    </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="s">&quot;:header-rows: 1</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">directions</span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">[</span><span class="n">thevars</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">keys</span>

<span class="w">    </span><span class="n">sdirs</span><span class="o">=</span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;forward&quot;</span><span class="o">=&gt;</span><span class="s">&quot;fw&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="o">=&gt;</span><span class="s">&quot;bw&quot;</span><span class="p">,</span><span class="s">&quot;combined&quot;</span><span class="o">=&gt;</span><span class="s">&quot;cb&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="nb">ENV</span><span class="p">,</span><span class="s">&quot;JUPYTER_BOOK_BUILD&quot;</span><span class="p">,</span><span class="s">&quot;false&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">include_mean</span>
<span class="w">            </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="s">&quot;* - Variable</span><span class="se">\n</span><span class="s"> &quot;</span><span class="o">*</span><span class="w"> </span><span class="n">mapreduce</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="s">&quot;  - </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> mean value</span><span class="se">\n</span><span class="s">  - </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> mean(diff)</span><span class="se">\n</span><span class="s">  - </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> std(diff)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">directions</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="s">&quot;* - Variable</span><span class="se">\n</span><span class="s"> &quot;</span><span class="o">*</span><span class="w"> </span><span class="n">mapreduce</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="s">&quot;  - </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> mean(diff)</span><span class="se">\n</span><span class="s">  - </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> std(diff)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">directions</span><span class="p">)</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">thevars</span>
<span class="w">            </span><span class="n">vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">show_units</span>
<span class="w">                </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="s">&quot;* - </span><span class="si">$</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="n">var</span><span class="p">))</span><span class="s"> [</span><span class="si">$</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="n">var</span><span class="p">])</span><span class="s">]</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="s">&quot;* - </span><span class="si">$</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="n">var</span><span class="p">))</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">include_mean</span>
<span class="w">                </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">mapreduce</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="s">&quot;  - </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">meanvalue</span><span class="p">)</span><span class="se">\n</span><span class="s">  - </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="se">\n</span><span class="s">  - </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="o">*</span><span class="p">,(</span><span class="n">vals</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">directions</span><span class="p">))</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">mapreduce</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="s">&quot;  - </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="se">\n</span><span class="s">  - </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="o">*</span><span class="p">,(</span><span class="n">vals</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">directions</span><span class="p">))</span><span class="w"> </span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="c">#outstring *=  (@sprintf &quot;  - %.3f\n  - %.3f\n&quot; vals.mean vals.std)</span>
<span class="w">            </span><span class="c">#</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="s">&quot;```&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">outstring</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;~~~markdown</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">*</span><span class="n">outstring</span><span class="o">*</span><span class="s">&quot;</span><span class="se">\n</span><span class="s"># table content (skipped in notebook) ```</span><span class="se">\n</span><span class="s">~~~</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="s">&quot;| Variable |&quot;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">include_mean</span>
<span class="w">            </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">mapreduce</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="s">&quot; </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> mean value | </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> mean(diff) | </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> std(diff) |&quot;</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">directions</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">mapreduce</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="s">&quot; </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> mean(diff) | </span><span class="si">$</span><span class="p">(</span><span class="n">sdirs</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="s"> std(diff) |&quot;</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">directions</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="c">#outstring *=&quot;| Variable |&quot;*&quot; mean(diff) | std(diff) |&quot;^(length(directions))*&quot;\n&quot;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">include_mean</span>
<span class="w">            </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="s">&quot;| --- &quot;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="s">&quot;| --- |&quot;</span><span class="o">*</span><span class="s">&quot; --- | --- |&quot;</span><span class="o">^</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">directions</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">thevars</span>
<span class="w">            </span><span class="n">vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">show_units</span>
<span class="w">                </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="s">&quot;| </span><span class="si">$</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="n">var</span><span class="p">))</span><span class="s"> [</span><span class="si">$</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="n">var</span><span class="p">])</span><span class="s">] |&quot;</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="s">&quot;| </span><span class="si">$</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="n">var</span><span class="p">))</span><span class="s"> |&quot;</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">include_mean</span>
<span class="w">                </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">mapreduce</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="s">&quot; </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">meanvalue</span><span class="p">)</span><span class="s"> | </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="s"> | </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">)</span><span class="s"> |&quot;</span><span class="p">,</span><span class="o">*</span><span class="p">,(</span><span class="n">vals</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">directions</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">outstring</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">mapreduce</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="s">&quot; </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="s"> | </span><span class="si">$</span><span class="p">(</span><span class="nd">@sprintf</span><span class="w"> </span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">)</span><span class="s"> |&quot;</span><span class="p">,</span><span class="o">*</span><span class="p">,(</span><span class="n">vals</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">directions</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="c">#outstring *= &quot;| $(uppercase(var)) | $(@sprintf &quot;%.3f&quot; vals.mean) | $(@sprintf &quot;%.3f&quot; vals.std) |\n&quot;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">outstring</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">calculate_overall_performances</span><span class="p">([</span><span class="n">scene1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">gdata1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;combined&quot;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">100</span><span class="p">])</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="w"> </span><span class="n">markdown_table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s">&quot;scene 1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="n">include_mean</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="n">show_units</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/markdown&quot;</span><span class="p">,</span><span class="n">Markdown</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="pst-scrollable-table-container"><table class="table" id="performance-1">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">Performance metric for scene 1</span><a class="headerlink" href="#performance-1" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>cb mean value</p></th>
<th class="head"><p>cb mean(diff)</p></th>
<th class="head"><p>cb std(diff)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WS [m/s]</p></td>
<td><p>9.189</p></td>
<td><p>-1.124</p></td>
<td><p>4.896</p></td>
</tr>
<tr class="row-odd"><td><p>TWV [kg/m²]</p></td>
<td><p>3.286</p></td>
<td><p>1.033</p></td>
<td><p>11.918</p></td>
</tr>
<tr class="row-even"><td><p>CLW [kg/m²]</p></td>
<td><p>-0.023</p></td>
<td><p>0.007</p></td>
<td><p>0.212</p></td>
</tr>
<tr class="row-odd"><td><p>SST [K]</p></td>
<td><p>275.082</p></td>
<td><p>0.014</p></td>
<td><p>1.283</p></td>
</tr>
<tr class="row-even"><td><p>IST [K]</p></td>
<td><p>260.380</p></td>
<td><p>-0.362</p></td>
<td><p>1.302</p></td>
</tr>
<tr class="row-odd"><td><p>SIC [1]</p></td>
<td><p>0.482</p></td>
<td><p>0.003</p></td>
<td><p>0.186</p></td>
</tr>
<tr class="row-even"><td><p>MYI [1]</p></td>
<td><p>0.253</p></td>
<td><p>0.128</p></td>
<td><p>0.377</p></td>
</tr>
<tr class="row-odd"><td><p>SIT [cm]</p></td>
<td><p>81.951</p></td>
<td><p>13.787</p></td>
<td><p>61.831</p></td>
</tr>
<tr class="row-even"><td><p>SSS [ppt]</p></td>
<td><p>30.004</p></td>
<td><p>-0.829</p></td>
<td><p>2.210</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In table <a class="reference internal" href="#performance-1"><span class="std std-numref">Table 3</span></a> the mean difference and the root mean square difference between the retrieved parameters from the input data and the L1b data are shown in forward and backward combined scans (cb). The differences are very small as expected. The differences are only visible at the ice edges and at the intermediate ice concentration where slight scan pattern are visible from the simulated L1b data.</p>
</section>
</section>
<section id="devalgo-test-scene-2-geometric-scene">
<h2>DEVALGO test scene 2 - Geometric scene<a class="headerlink" href="#devalgo-test-scene-2-geometric-scene" title="Link to this heading">#</a></h2>
<section id="retrieval-before-and-after-the-satellite-simulator-for-the-geometric-scene">
<h3>Retrieval before and after the satellite simulator for the geometric scene<a class="headerlink" href="#retrieval-before-and-after-the-satellite-simulator-for-the-geometric-scene" title="Link to this heading">#</a></h3>
<p>We perform the same comparison for the test scene 2, also for the forward scan. This scene is also called the <em>geometric scene</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#get cimer results</span>
<span class="c">#scene2 = let dir=&quot;forward&quot;</span>
<span class="n">scene2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Dict</span><span class="p">()</span>
<span class="k">for</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">test2datac</span><span class="p">,</span><span class="n">test2derror</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">project_data</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scene2</span><span class="o">.</span><span class="n">l1b</span><span class="p">,</span><span class="s">&quot;C_BAND&quot;</span><span class="p">,</span><span class="n">dir</span><span class="p">)</span>
<span class="w">    </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">lltoxy</span><span class="o">.</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">last</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="n">pygc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="w">    </span><span class="n">GC</span><span class="o">.</span><span class="n">gc</span><span class="p">()</span>
<span class="w">    </span><span class="n">dat</span><span class="p">,</span><span class="n">err</span><span class="p">,</span><span class="n">res</span><span class="o">=</span><span class="n">run_oem</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">test2datac</span><span class="p">))</span>
<span class="w">    </span><span class="n">scene2</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">dir</span><span class="o">=</span><span class="s">&quot;forward&quot;</span>
<span class="w">    </span><span class="n">fig</span><span class="o">=</span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">scene2</span><span class="p">,</span><span class="n">dir</span><span class="p">,</span><span class="n">swath</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:false</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Retrieved parameters for scene 2 in the forward scan direction.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scene2_params_forward&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="scene2-params-forward">
<img alt="_images/figure_scene2_params_forward.png" src="_images/figure_scene2_params_forward.png" />
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Retrieved parameters for scene 2 in the forward scan direction.</span><a class="headerlink" href="#scene2-params-forward" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>It can be seen from <a class="reference internal" href="#scene2-params-forward"><span class="std std-numref">Fig. 15</span></a>, that in this test scene, the different shapes and patterns are a major challenge for the retrieval and the smearing introduced by the lower resolution channels is more apparent. For the mask here again only the retrieved ice concentration is used, like before with the radiometric scene.</p>
<p>Then we read again the input and apply the retrieval to that data for comparison.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">gdata2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">let</span>
<span class="w">    </span><span class="n">test2data</span><span class="p">,</span><span class="n">lea</span><span class="p">,</span><span class="n">imextent</span><span class="p">,</span><span class="n">surfaces</span><span class="o">=</span><span class="n">read_testscene</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scene2</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
<span class="w">    </span><span class="n">pygc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="w">    </span><span class="n">GC</span><span class="o">.</span><span class="n">gc</span><span class="p">()</span>
<span class="w">    </span><span class="n">tdat</span><span class="p">,</span><span class="n">terr</span><span class="p">,</span><span class="n">tres</span><span class="o">=</span><span class="n">run_oem</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">test2data</span><span class="p">))</span>
<span class="w">    </span><span class="kt">NamedTuple</span><span class="p">{(</span><span class="ss">:ws</span><span class="p">,</span><span class="w"> </span><span class="ss">:twv</span><span class="p">,</span><span class="w"> </span><span class="ss">:clw</span><span class="p">,</span><span class="w"> </span><span class="ss">:sst</span><span class="p">,</span><span class="w"> </span><span class="ss">:ist</span><span class="p">,</span><span class="w"> </span><span class="ss">:sic</span><span class="p">,</span><span class="w"> </span><span class="ss">:myi</span><span class="p">,</span><span class="w"> </span><span class="ss">:sit</span><span class="p">,</span><span class="w"> </span><span class="ss">:sss</span><span class="p">)}(</span><span class="n">reshape</span><span class="p">(</span><span class="n">tdat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="mi">1400</span><span class="p">,</span><span class="mi">1400</span><span class="p">)[</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">9</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>We focus on the sea ice concentration also on test scene 2 in <a class="reference internal" href="#sic-comparison-scene2"><span class="std std-numref">Fig. 16</span></a>. Here again, the difference is rather small and only visible at the edges of the ice, and the edges of the scene.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">scene2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scene2</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">))</span>
<span class="w">    </span><span class="n">scene</span><span class="o">=</span><span class="mi">2</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;SIC on CIMR input, scene </span><span class="si">$scene</span><span class="s">&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gdata2</span><span class="o">.</span><span class="n">sic</span><span class="w"> </span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="n">imextent</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;SIC on CIMR output, scene </span><span class="si">$scene</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">outsic</span><span class="o">=</span><span class="n">OEM</span><span class="o">.</span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">scene2</span><span class="o">.</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">scene2</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="n">scene2</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span><span class="n">lea</span><span class="p">)</span>

<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">outsic</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;difference&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">outsic</span><span class="o">.-</span><span class="n">gdata2</span><span class="o">.</span><span class="n">sic</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">&quot;RdBu_r&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SIC on CIMR input, output and difference for scene 2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SIC_comparison_scene2&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="sic-comparison-scene2">
<img alt="_images/figure_SIC_comparison_scene2.png" src="_images/figure_SIC_comparison_scene2.png" />
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">SIC on CIMR input, output and difference for scene 2</span><a class="headerlink" href="#sic-comparison-scene2" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="performance-metrics-for-the-geometric-scene">
<h3>Performance metrics for the geometric scene<a class="headerlink" href="#performance-metrics-for-the-geometric-scene" title="Link to this heading">#</a></h3>
<p>Also for this scene we can calculate the performance of the retrieval on the input data and the L1b data. The results are shown in table <a class="reference internal" href="#performance-2"><span class="std std-numref">Table 4</span></a>. The bias is very small, while the RMSE is similar to the RMSE in the radiometric scene.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">calculate_overall_performances</span><span class="p">([</span><span class="n">scene2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">gdata2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;combined&quot;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">100</span><span class="p">])</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="w"> </span><span class="n">markdown_table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s">&quot;scene 2&quot;</span><span class="p">,</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">include_mean</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/markdown&quot;</span><span class="p">,</span><span class="n">Markdown</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="pst-scrollable-table-container"><table class="table" id="performance-2">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">Performance metric for scene 2</span><a class="headerlink" href="#performance-2" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>cb mean value</p></th>
<th class="head"><p>cb mean(diff)</p></th>
<th class="head"><p>cb std(diff)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WS [m/s]</p></td>
<td><p>7.208</p></td>
<td><p>-0.960</p></td>
<td><p>3.977</p></td>
</tr>
<tr class="row-odd"><td><p>TWV [kg/m²]</p></td>
<td><p>0.746</p></td>
<td><p>2.173</p></td>
<td><p>14.140</p></td>
</tr>
<tr class="row-even"><td><p>CLW [kg/m²]</p></td>
<td><p>-0.110</p></td>
<td><p>0.026</p></td>
<td><p>0.175</p></td>
</tr>
<tr class="row-odd"><td><p>SST [K]</p></td>
<td><p>274.980</p></td>
<td><p>0.171</p></td>
<td><p>1.594</p></td>
</tr>
<tr class="row-even"><td><p>IST [K]</p></td>
<td><p>260.253</p></td>
<td><p>-0.266</p></td>
<td><p>1.490</p></td>
</tr>
<tr class="row-odd"><td><p>SIC [1]</p></td>
<td><p>0.332</p></td>
<td><p>0.007</p></td>
<td><p>0.172</p></td>
</tr>
<tr class="row-even"><td><p>MYI [1]</p></td>
<td><p>0.196</p></td>
<td><p>0.122</p></td>
<td><p>0.415</p></td>
</tr>
<tr class="row-odd"><td><p>SIT [cm]</p></td>
<td><p>84.410</p></td>
<td><p>14.630</p></td>
<td><p>63.438</p></td>
</tr>
<tr class="row-even"><td><p>SSS [ppt]</p></td>
<td><p>29.957</p></td>
<td><p>-0.882</p></td>
<td><p>2.687</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="test-scene-sceps-polar-scene">
<h2>Test scene SCEPS - Polar scene<a class="headerlink" href="#test-scene-sceps-polar-scene" title="Link to this heading">#</a></h2>
<p>We perform the same comparison for the SCEPS polar test scene.</p>
<p>Then we read again the input and apply the retrieval to that data for comparison. Since the format of the SCEPS input scene is slightly different, we have another reading routine for this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="kt">Dict</span><span class="p">()</span>
<span class="n">scenep</span><span class="o">=</span><span class="kt">Dict</span><span class="p">()</span>
<span class="k">for</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">test2datac</span><span class="p">,</span><span class="n">test2errorc</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">project_data</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scenep</span><span class="o">.</span><span class="n">l1b</span><span class="p">,</span><span class="s">&quot;C_BAND&quot;</span><span class="p">,</span><span class="n">dir</span><span class="p">,</span><span class="n">oza_corr</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">lltoxy</span><span class="o">.</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">last</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="n">dat</span><span class="p">,</span><span class="n">errr</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">its</span><span class="o">=</span><span class="n">run_oem</span><span class="p">(</span><span class="n">test2datac</span><span class="p">)</span>
<span class="w">    </span><span class="n">data</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span><span class="o">=</span><span class="kt">NamedTuple</span><span class="p">{(</span><span class="ss">:ws</span><span class="p">,</span><span class="w"> </span><span class="ss">:twv</span><span class="p">,</span><span class="w"> </span><span class="ss">:clw</span><span class="p">,</span><span class="w"> </span><span class="ss">:sst</span><span class="p">,</span><span class="w"> </span><span class="ss">:ist</span><span class="p">,</span><span class="w"> </span><span class="ss">:sic</span><span class="p">,</span><span class="w"> </span><span class="ss">:myi</span><span class="p">,</span><span class="w"> </span><span class="ss">:sit</span><span class="p">,</span><span class="w"> </span><span class="ss">:sss</span><span class="p">)}(</span><span class="n">OEM</span><span class="o">.</span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">lea</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">9</span><span class="p">)</span>
<span class="w">    </span><span class="n">scenep</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span><span class="o">=</span><span class="p">(;</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">errr</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">its</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p>Here we can discuss the results of the multi parameter retrieval on a the polar scene and give some interpretation of the results. We are lookingn into the combined results from the forward and backward scans. Since we use a simplistic near-neighbour approach, we expect some noise in the results, where the retrieval on the forward and backward scans do not match well. Three different quantities are shown here</p>
<ul class="simple">
<li><p>the retrieved parameters <a class="reference internal" href="#retrieval-polar-combined"><span class="std std-numref">Fig. 17</span></a></p></li>
<li><p>the uncertainty of the retrieval <a class="reference internal" href="#uncertainty-polar-combined"><span class="std std-numref">Fig. 18</span></a></p></li>
<li><p>the improvement of our knowledge of the parameters (one minus square root of diagonal of the covariance matrix) <a class="reference internal" href="#improvement-polar-combined"><span class="std std-numref">Fig. 19</span></a></p></li>
</ul>
<p>The results are shown in the following plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">dir</span><span class="o">=</span><span class="s">&quot;combined&quot;</span>
<span class="w">    </span><span class="n">fig</span><span class="o">=</span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">scenep</span><span class="p">,</span><span class="n">dir</span><span class="p">,</span><span class="w"> </span><span class="n">swath</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,</span><span class="ss">:land</span><span class="p">),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:false</span><span class="p">)</span>
<span class="w">    </span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Retrieval results for the nine parameters for the combined forward and backward scans for the SCEPS polar scene.&quot;</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">description</span><span class="p">,</span><span class="s">&quot;retrieval_polar_combined&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="retrieval-polar-combined">
<img alt="_images/figure_retrieval_polar_combined.png" src="_images/figure_retrieval_polar_combined.png" />
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">Retrieval results for the nine parameters for the combined forward and backward scans for the SCEPS polar scene.</span><a class="headerlink" href="#retrieval-polar-combined" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>The quantities are reasonable, while some have a bit more noise and others are more stable. The <a class="reference internal" href="acronyms.html#term-SIC"><span class="xref std std-term">SIC</span></a> is very smooth with little noise which is expected as it has the highest influence on the brightness temperatures. <a class="reference internal" href="acronyms.html#term-SSS"><span class="xref std std-term">SSS</span></a>, <a class="reference internal" href="acronyms.html#term-IST"><span class="xref std std-term">IST</span></a> and <a class="reference internal" href="acronyms.html#term-SST"><span class="xref std std-term">SST</span></a> look flat, as if not the real variability of these variables is preserved. This is due to the fact that the retrieval is not very sensitive to these parameters. The <a class="reference internal" href="acronyms.html#term-SIC"><span class="xref std std-term">SIC</span></a> is the most important parameter for the retrieval and the other parameters are more relying on the apri ori data. The uncertainty of the retrieval is quite high for the <a class="reference internal" href="acronyms.html#term-SSS"><span class="xref std std-term">SSS</span></a>, <a class="reference internal" href="acronyms.html#term-IST"><span class="xref std std-term">IST</span></a> and <a class="reference internal" href="acronyms.html#term-SST"><span class="xref std std-term">SST</span></a>, while it is low for the <a class="reference internal" href="acronyms.html#term-SIC"><span class="xref std std-term">SIC</span></a>. This can be seen when we plot the uncertainty of the retrieval below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">dir</span><span class="o">=</span><span class="s">&quot;combined&quot;</span>
<span class="w">    </span><span class="n">fig</span><span class="o">=</span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">scenep</span><span class="p">,</span><span class="n">dir</span><span class="p">,</span><span class="w"> </span><span class="n">swath</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,</span><span class="ss">:land</span><span class="p">),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:true</span><span class="p">)</span>
<span class="w">    </span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Retrieval uncertainty for the nine parameters for the combined forward and backward scans for the SCEPS polar scene.&quot;</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">description</span><span class="p">,</span><span class="s">&quot;uncertainty_polar_combined&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="uncertainty-polar-combined">
<img alt="_images/figure_uncertainty_polar_combined.png" src="_images/figure_uncertainty_polar_combined.png" />
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">Retrieval uncertainty for the nine parameters for the combined forward and backward scans for the SCEPS polar scene.</span><a class="headerlink" href="#uncertainty-polar-combined" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>The comparison to the prior uncertainty shows that the retrieval improves our knowledge of the parameters. The improvement is highest for the <a class="reference internal" href="acronyms.html#term-SIC"><span class="xref std std-term">SIC</span></a> except over the ice edge, while it is lowest for the <a class="reference internal" href="acronyms.html#term-IST"><span class="xref std std-term">IST</span></a> and <a class="reference internal" href="acronyms.html#term-SSS"><span class="xref std std-term">SSS</span></a> as these variables have little influence on the resulting TBs compared to the others. Also the <a class="reference internal" href="acronyms.html#term-CLW"><span class="xref std std-term">CLW</span></a> and the <a class="reference internal" href="acronyms.html#term-SIT"><span class="xref std std-term">SIT</span></a> was show a good improvement of our knowledge by performing the retrieval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">dir</span><span class="o">=</span><span class="s">&quot;combined&quot;</span>
<span class="w">    </span><span class="n">fig</span><span class="o">=</span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">scenep</span><span class="p">,</span><span class="n">dir</span><span class="p">,</span><span class="w"> </span><span class="n">swath</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,</span><span class="ss">:land</span><span class="p">),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:ratio</span><span class="p">)</span>
<span class="w">    </span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Retrieval knowledge improvement for the nine parameters for the combined forward and backward scans for the SCEPS polar scene. Zeros means no improvement over prior, while ones means vast improvement.&quot;</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">description</span><span class="p">,</span><span class="s">&quot;improvement_polar_combined&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="improvement-polar-combined">
<img alt="_images/figure_improvement_polar_combined.png" src="_images/figure_improvement_polar_combined.png" />
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">Retrieval knowledge improvement for the nine parameters for the combined forward and backward scans for the SCEPS polar scene. Zeros means no improvement over prior, while ones means vast improvement.</span><a class="headerlink" href="#improvement-polar-combined" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Next we do a comparison to the retrieval on the <em>input</em> data to the satellite simulator is done. This is done to show that the retrieval is able to retrieve the parameters from the input data. We do not explicitly compare all variables here for the retrieval on input and output data of the simulator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">gdatap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">let</span>
<span class="w">    </span><span class="n">stest</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">imextent</span><span class="o">=</span><span class="n">OEM</span><span class="o">.</span><span class="n">read_testscene_sceps</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scenep</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
<span class="w">    </span><span class="n">tdat</span><span class="p">,</span><span class="n">terr</span><span class="p">,</span><span class="n">tres</span><span class="o">=</span><span class="n">run_oem</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">stest</span><span class="p">))</span>

<span class="w">    </span><span class="kt">NamedTuple</span><span class="p">{(</span><span class="ss">:ws</span><span class="p">,</span><span class="w"> </span><span class="ss">:twv</span><span class="p">,</span><span class="w"> </span><span class="ss">:clw</span><span class="p">,</span><span class="w"> </span><span class="ss">:sst</span><span class="p">,</span><span class="w"> </span><span class="ss">:ist</span><span class="p">,</span><span class="w"> </span><span class="ss">:sic</span><span class="p">,</span><span class="w"> </span><span class="ss">:myi</span><span class="p">,</span><span class="w"> </span><span class="ss">:sit</span><span class="p">,</span><span class="w"> </span><span class="ss">:sss</span><span class="p">)}(</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="n">cdat</span><span class="o">=</span><span class="n">reshape</span><span class="p">(</span><span class="n">tdat</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="mi">1400</span><span class="p">,</span><span class="mi">1400</span><span class="p">)</span><span class="o">|&gt;</span><span class="n">rotl90</span><span class="w"> </span><span class="c">#somehow the data is rotated</span>
<span class="w">            </span><span class="n">cdat</span><span class="p">[</span><span class="n">landmask</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">            </span><span class="n">cdat</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">9</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>As an example, we discuss the <a class="reference internal" href="acronyms.html#term-SIC"><span class="xref std std-term">SIC</span></a> from the retrieval and compare between the retrieval applied to the input data and the L1b data. The difference is very small as expected, as the simulator is only adding noise and a smearing of the footprints to the data. The difference is only visible at the ice edges and at the intermediate ice concentration where slight scan pattern are visible from the simulated L1b data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">))</span>
<span class="w">    </span><span class="n">scene</span><span class="o">=</span><span class="s">&quot;polar&quot;</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;SIC on CIMR input </span><span class="si">$scene</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gdatap</span><span class="o">.</span><span class="n">sic</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;SIC on CIMR output, scene </span><span class="si">$scene</span><span class="s">&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">outsic</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sic</span>
<span class="w">    </span><span class="n">outsic</span><span class="p">[</span><span class="n">landmask</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">outsic</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;difference&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sic</span><span class="o">.-</span><span class="n">gdatap</span><span class="o">.</span><span class="n">sic</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">&quot;RdBu_r&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="s">&quot;SIC comparison between CIMR input and output for scene </span><span class="si">$scene</span><span class="s">, SIC on CIMR input TBs (left), SIC on CIMR output, the L1b (middle), their difference (right)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SIC_comparison_</span><span class="si">$scene</span><span class="s">.png&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="sic-comparison-polar-png">
<img alt="_images/figure_SIC_comparison_polar.png.png" src="_images/figure_SIC_comparison_polar.png.png" />
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">SIC comparison between CIMR input and output for scene polar, SIC on CIMR input TBs (left), SIC on CIMR output, the L1b (middle), their difference (right)</span><a class="headerlink" href="#sic-comparison-polar-png" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Analog to the other scenes, we calculate the performance of the retrieval on the input data and the L1b data. The combined results for forward and backward scan are in table <a class="reference internal" href="#performance-polar-combined"><span class="std std-numref">Table 5</span></a>. Here we did not remove the border pixels from the comparison, as the SCEPS polar scene does not have a 0 K border as the other scenes. The table shows the smallest mean difference (bias) in <a class="reference internal" href="acronyms.html#term-SIC"><span class="xref std std-term">SIC</span></a>, <a class="reference internal" href="acronyms.html#term-CLW"><span class="xref std std-term">CLW</span></a> and <a class="reference internal" href="acronyms.html#term-MYI"><span class="xref std std-term">MYI</span></a>, while the other variables also show good performance. The standard deviation of the difference is a measure of how far the results spread around the mean difference. <a class="reference internal" href="acronyms.html#term-TWV"><span class="xref std std-term">TWV</span></a> and <a class="reference internal" href="acronyms.html#term-WS"><span class="xref std std-term">WS</span></a> show very high values, but also the SSS and SIT values are quite large. The SIC as the value with the smallest bias, also has very low spread.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">calculate_overall_performances</span><span class="p">([</span><span class="n">scenep</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">gdatap</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;combined&quot;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="w"> </span><span class="n">markdown_table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s">&quot;scene 1&quot;</span><span class="p">,</span><span class="s">&quot;polar-combined&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/markdown&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="pst-scrollable-table-container"><table class="table" id="performance-polar-combined">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Performance metric for scene 1</span><a class="headerlink" href="#performance-polar-combined" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>cb mean(diff)</p></th>
<th class="head"><p>cb std(diff)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WS [m/s]</p></td>
<td><p>-0.155</p></td>
<td><p>3.501</p></td>
</tr>
<tr class="row-odd"><td><p>TWV [kg/m²]</p></td>
<td><p>-0.156</p></td>
<td><p>4.588</p></td>
</tr>
<tr class="row-even"><td><p>CLW [kg/m²]</p></td>
<td><p>0.003</p></td>
<td><p>0.072</p></td>
</tr>
<tr class="row-odd"><td><p>SST [K]</p></td>
<td><p>-0.196</p></td>
<td><p>0.439</p></td>
</tr>
<tr class="row-even"><td><p>IST [K]</p></td>
<td><p>-0.000</p></td>
<td><p>0.379</p></td>
</tr>
<tr class="row-odd"><td><p>SIC [1]</p></td>
<td><p>0.007</p></td>
<td><p>0.056</p></td>
</tr>
<tr class="row-even"><td><p>MYI [1]</p></td>
<td><p>0.006</p></td>
<td><p>0.092</p></td>
</tr>
<tr class="row-odd"><td><p>SIT [cm]</p></td>
<td><p>4.162</p></td>
<td><p>18.406</p></td>
</tr>
<tr class="row-even"><td><p>SSS [ppt]</p></td>
<td><p>0.092</p></td>
<td><p>1.417</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We are loading the SCEPS polar scene reference geophysical data for comparison. It is already in EASE2 projection with the same grid as the reference brightness temperatures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">gdata_true</span><span class="p">,</span><span class="n">latt</span><span class="p">,</span><span class="n">lont</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">let</span>
<span class="w">     </span><span class="c">#fn=&quot;/home/huntemann/CIMR_L1X/cimr_sceps_geo_card_polarscene_1_20161217_v1p0_part1.nc&quot;</span>
<span class="w">    </span><span class="n">fn</span><span class="o">=</span><span class="n">fns</span><span class="o">.</span><span class="n">scenep</span><span class="o">.</span><span class="n">geo</span>


<span class="w">    </span><span class="kt">NamedTuple</span><span class="p">{(</span><span class="ss">:ws</span><span class="p">,</span><span class="w"> </span><span class="ss">:twv</span><span class="p">,</span><span class="w"> </span><span class="ss">:clw</span><span class="p">,</span><span class="w"> </span><span class="ss">:sst</span><span class="p">,</span><span class="w"> </span><span class="ss">:ist</span><span class="p">,</span><span class="w"> </span><span class="ss">:sic</span><span class="p">,</span><span class="w"> </span><span class="ss">:myi</span><span class="p">,</span><span class="w"> </span><span class="ss">:sit</span><span class="p">,</span><span class="w"> </span><span class="ss">:sss</span><span class="p">,</span><span class="w"> </span><span class="ss">:snd</span><span class="p">,</span><span class="w"> </span><span class="ss">:fdn</span><span class="p">)}((</span>
<span class="w">    </span><span class="p">(((</span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;surface_wind_u&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.^</span><span class="mf">2f0</span>
<span class="w">    </span><span class="o">.+</span><span class="p">(</span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;surface_wind_v&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.^</span><span class="mf">2f0</span><span class="p">)</span><span class="o">.^</span><span class="p">(</span><span class="mf">0.5f0</span><span class="p">))[</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;total_column_water_vapour&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;total_column_liquid_water&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;sea_surface_temperature&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;sea_ice_temperature&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;sea_ice_concentration&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span><span class="o">/</span><span class="mf">100.0f0</span><span class="p">,</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;sea_ice_type&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="w"> </span><span class="c">#1=multiyear, 0=first year (or no ice)</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;sea_ice_thickness&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span><span class="o">*</span><span class="mf">100.0f0</span><span class="p">,</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;sea_surface_salinity&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;snow_thickness&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span><span class="o">*</span><span class="mf">100.0f0</span><span class="p">,</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;freezing_days_number&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="w">    </span><span class="p">)),</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;latitude&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">],</span>
<span class="w">    </span><span class="n">NCDataset</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="s">&quot;longitude&quot;</span><span class="p">][</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="k">end</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">]</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>Here we get an overview over the reference values of the SCEPS polar scene.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#overview plot of all gdata_true variables 3x3 grid</span>
<span class="n">mmdict</span><span class="o">=</span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;ws&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s">&quot;twv&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s">&quot;clw&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span><span class="s">&quot;sst&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">250</span><span class="p">,</span><span class="mi">280</span><span class="p">],</span><span class="s">&quot;ist&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">250</span><span class="p">,</span><span class="mi">280</span><span class="p">],</span><span class="s">&quot;sic&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s">&quot;myi&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s">&quot;sit&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">],</span><span class="s">&quot;sss&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">28</span><span class="p">,</span><span class="mi">35</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;snd&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="s">&quot;fdn&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
<span class="c">#variable names and units</span>
<span class="n">labdict</span><span class="o">=</span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;ws&quot;</span><span class="o">=&gt;</span><span class="s">&quot;wind speed [m/s]&quot;</span><span class="p">,</span><span class="s">&quot;twv&quot;</span><span class="o">=&gt;</span><span class="s">&quot;total water vapor [kg/m²]&quot;</span><span class="p">,</span><span class="s">&quot;clw&quot;</span><span class="o">=&gt;</span><span class="s">&quot;cloud liquid water [kg/m²]&quot;</span><span class="p">,</span><span class="s">&quot;sst&quot;</span><span class="o">=&gt;</span><span class="s">&quot;sea surface temperature [K]&quot;</span><span class="p">,</span><span class="s">&quot;ist&quot;</span><span class="o">=&gt;</span><span class="s">&quot;ice surface temperature [K]&quot;</span><span class="p">,</span><span class="s">&quot;sic&quot;</span><span class="o">=&gt;</span><span class="s">&quot;sea ice concentration [1]&quot;</span><span class="p">,</span><span class="s">&quot;myi&quot;</span><span class="o">=&gt;</span><span class="s">&quot;multi year ice fraction [1]&quot;</span><span class="p">,</span><span class="s">&quot;sit&quot;</span><span class="o">=&gt;</span><span class="s">&quot;first year ice thickness [cm]&quot;</span><span class="p">,</span><span class="s">&quot;sss&quot;</span><span class="o">=&gt;</span><span class="s">&quot;sea surface salinity [ppt]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;snd&quot;</span><span class="o">=&gt;</span><span class="s">&quot;snow thickness [cm]&quot;</span><span class="p">,</span><span class="s">&quot;fdn&quot;</span><span class="o">=&gt;</span><span class="s">&quot;freezing days number [1]&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span><span class="n">subplot_kw</span><span class="o">=</span><span class="n">PyDict</span><span class="p">(</span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;projection&quot;</span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ccrs</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">pyconvert</span><span class="p">(</span><span class="kt">Array</span><span class="p">,</span><span class="n">ax</span><span class="p">)[</span><span class="o">:</span><span class="p">]</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">varname</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="kt">Symbol</span><span class="o">.</span><span class="p">((</span><span class="s">&quot;ws&quot;</span><span class="p">,</span><span class="s">&quot;twv&quot;</span><span class="p">,</span><span class="s">&quot;clw&quot;</span><span class="p">,</span><span class="s">&quot;sst&quot;</span><span class="p">,</span><span class="s">&quot;ist&quot;</span><span class="p">,</span><span class="s">&quot;sic&quot;</span><span class="p">,</span><span class="s">&quot;myi&quot;</span><span class="p">,</span><span class="s">&quot;sit&quot;</span><span class="p">,</span><span class="s">&quot;sss&quot;</span><span class="p">)))</span>
<span class="w">    </span><span class="n">mins</span><span class="p">,</span><span class="n">maxs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mmdict</span><span class="p">[</span><span class="n">string</span><span class="p">(</span><span class="n">varname</span><span class="p">)]</span>
<span class="w">    </span><span class="n">pos</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">getfield</span><span class="p">(</span><span class="n">gdata_true</span><span class="p">,</span><span class="n">varname</span><span class="p">),</span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">mins</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">maxs</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">&quot;viridis&quot;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">cb</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;vertical&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">labdict</span><span class="p">[</span><span class="n">string</span><span class="p">(</span><span class="n">varname</span><span class="p">)])</span>
<span class="w">    </span><span class="c">#ax[i].set_extent(extent,mycrs)</span>
<span class="w">    </span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="k">end</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="c">#display(&quot;image/png&quot;,fig)</span>
<span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SCEPS Polar scene reference geophysical data for the nine variables which are also used in the multi parameter retrieval.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sceps_polar_reference&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="sceps-polar-reference">
<img alt="_images/figure_sceps_polar_reference.png" src="_images/figure_sceps_polar_reference.png" />
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">SCEPS Polar scene reference geophysical data for the nine variables which are also used in the multi parameter retrieval.</span><a class="headerlink" href="#sceps-polar-reference" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Here we perform a comparison of the SCEPS polar scene reference data to the retrieval performed on L1b data.</p>
<ul class="simple">
<li><p>Wind Speed (WS): A similar pattern is visible in both datasets. The retrieval shows a little higher values in general (<a class="reference internal" href="#ref-comparison-ws"><span class="std std-numref">Fig. 22</span></a>).</p></li>
<li><p>Total Water Vapor (TWV): The pattern is similar, but the retrieval shows lower values in general. The retrieval shows discontinuity over the ice edge (<a class="reference internal" href="#ref-comparison-twv"><span class="std std-numref">Fig. 23</span></a>).</p></li>
<li><p>Cloud Liquid Water (CLW): The pattern is similar, also the absolute range of values is similar. The retrieval shows a discontinuity over the ice edge (<a class="reference internal" href="#ref-comparison-clw"><span class="std std-numref">Fig. 24</span></a>).</p></li>
<li><p>Sea Surface Temperature (SST): The retrieval seems uniformly retrieving similar values close to the freezing point while the reference data shows more variation and higher temperatures (<a class="reference internal" href="#ref-comparison-sst"><span class="std std-numref">Fig. 25</span></a>).</p></li>
<li><p>Ice Surface Temperature (IST): The retrieval shows quite high values around the freezing point uniformly, while the reference data shows much lower temperatures closer towards the North pole (<a class="reference internal" href="#ref-comparison-ist"><span class="std std-numref">Fig. 26</span></a>).</p></li>
<li><p>Sea Ice Concentration (SIC): The retrieval shows a similar pattern as the reference data, but lower values at the ice edge (<a class="reference internal" href="#ref-comparison-sic"><span class="std std-numref">Fig. 27</span></a>).</p></li>
<li><p>Multi Year Ice Fraction (MYI): The reference data is binary (multiyear ice or not). All multiyear ice according to the reference is retrieved as increased multiyear ice fraction between 0.6 and 1.0, while the first year ice is retrieved as 0.0 as expected (<a class="reference internal" href="#ref-comparison-myi"><span class="std std-numref">Fig. 28</span></a>).</p></li>
<li><p>First Year Ice Thickness (SIT): The comparable first year ice area shows similar sea ice thickness, while the retrieval shows slightly lower values in general (<a class="reference internal" href="#ref-comparison-sit"><span class="std std-numref">Fig. 29</span></a>).</p></li>
<li><p>Sea Surface Salinity (SSS): The retrieval shows lower values close to the a priori value of 30ppt while the reference data has mostly values around 35ppt (<a class="reference internal" href="#ref-comparison-sss"><span class="std std-numref">Fig. 30</span></a>).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#varname=&quot;twv&quot;</span>
<span class="n">dir</span><span class="o">=</span><span class="s">&quot;forward&quot;</span>
<span class="k">for</span><span class="w"> </span><span class="n">varname</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;ws&quot;</span><span class="p">,</span><span class="s">&quot;twv&quot;</span><span class="p">,</span><span class="s">&quot;clw&quot;</span><span class="p">,</span><span class="s">&quot;sst&quot;</span><span class="p">,</span><span class="s">&quot;ist&quot;</span><span class="p">,</span><span class="s">&quot;sic&quot;</span><span class="p">,</span><span class="s">&quot;myi&quot;</span><span class="p">,</span><span class="s">&quot;sit&quot;</span><span class="p">,</span><span class="s">&quot;sss&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">mins</span><span class="p">,</span><span class="n">maxs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mmdict</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span>
<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mf">4.5</span><span class="p">))</span>
<span class="w">    </span><span class="n">scene</span><span class="o">=</span><span class="s">&quot;polar&quot;</span>
<span class="w">    </span><span class="c">#fig.suptitle(labdict[varname])</span>

<span class="w">    </span><span class="c">#left plot</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;</span><span class="si">$</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span><span class="s"> reference, scene </span><span class="si">$scene</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">truedat</span><span class="o">=</span><span class="n">getfield</span><span class="p">(</span><span class="n">gdata_true</span><span class="p">,</span><span class="kt">Symbol</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>
<span class="w">    </span><span class="n">truedat</span><span class="p">[</span><span class="n">landmask</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">truedat</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="n">mins</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">maxs</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="w">   </span>
<span class="w">    </span><span class="c">#center plot</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;</span><span class="si">$</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span><span class="s"> on CIMR output, scene </span><span class="si">$scene</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">retrdat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getfield</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">],</span><span class="kt">Symbol</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>
<span class="w">    </span><span class="n">retrdat</span><span class="p">[</span><span class="n">landmask</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">retrdat</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">mins</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">maxs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="c">#right plot</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;difference&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">diffs</span><span class="o">=</span><span class="n">getfield</span><span class="p">(</span><span class="n">gdata_true</span><span class="p">,</span><span class="kt">Symbol</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span><span class="o">.-</span><span class="n">getfield</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">dir</span><span class="p">],</span><span class="kt">Symbol</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>
<span class="w">    </span><span class="n">diffmax</span><span class="o">=</span><span class="n">quantile</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="n">isnan</span><span class="p">,</span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">diffs</span><span class="p">)[</span><span class="o">:</span><span class="p">])</span><span class="w"> </span><span class="p">,</span><span class="mf">0.95</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=-</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">&quot;RdBu_r&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&quot;horizontal&quot;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Comparison of </span><span class="si">$</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span><span class="s"> between reference dataset and retrieval.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ref_comparison_</span><span class="si">$</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="c">#display(&quot;image/png&quot;,fig)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="ref-comparison-ws">
<img alt="_images/figure_ref_comparison_ws.png" src="_images/figure_ref_comparison_ws.png" />
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">Comparison of WS between reference dataset and retrieval.</span><a class="headerlink" href="#ref-comparison-ws" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="ref-comparison-twv">
<img alt="_images/figure_ref_comparison_twv.png" src="_images/figure_ref_comparison_twv.png" />
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">Comparison of TWV between reference dataset and retrieval.</span><a class="headerlink" href="#ref-comparison-twv" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="ref-comparison-clw">
<img alt="_images/figure_ref_comparison_clw.png" src="_images/figure_ref_comparison_clw.png" />
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">Comparison of CLW between reference dataset and retrieval.</span><a class="headerlink" href="#ref-comparison-clw" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="ref-comparison-sst">
<img alt="_images/figure_ref_comparison_sst.png" src="_images/figure_ref_comparison_sst.png" />
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">Comparison of SST between reference dataset and retrieval.</span><a class="headerlink" href="#ref-comparison-sst" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="ref-comparison-ist">
<img alt="_images/figure_ref_comparison_ist.png" src="_images/figure_ref_comparison_ist.png" />
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">Comparison of IST between reference dataset and retrieval.</span><a class="headerlink" href="#ref-comparison-ist" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="ref-comparison-sic">
<img alt="_images/figure_ref_comparison_sic.png" src="_images/figure_ref_comparison_sic.png" />
<figcaption>
<p><span class="caption-number">Fig. 27 </span><span class="caption-text">Comparison of SIC between reference dataset and retrieval.</span><a class="headerlink" href="#ref-comparison-sic" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="ref-comparison-myi">
<img alt="_images/figure_ref_comparison_myi.png" src="_images/figure_ref_comparison_myi.png" />
<figcaption>
<p><span class="caption-number">Fig. 28 </span><span class="caption-text">Comparison of MYI between reference dataset and retrieval.</span><a class="headerlink" href="#ref-comparison-myi" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="ref-comparison-sit">
<img alt="_images/figure_ref_comparison_sit.png" src="_images/figure_ref_comparison_sit.png" />
<figcaption>
<p><span class="caption-number">Fig. 29 </span><span class="caption-text">Comparison of SIT between reference dataset and retrieval.</span><a class="headerlink" href="#ref-comparison-sit" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="ref-comparison-sss">
<img alt="_images/figure_ref_comparison_sss.png" src="_images/figure_ref_comparison_sss.png" />
<figcaption>
<p><span class="caption-number">Fig. 30 </span><span class="caption-text">Comparison of SSS between reference dataset and retrieval.</span><a class="headerlink" href="#ref-comparison-sss" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>A summary of the performance of the retrieval on the L1b data compared to the reference dataset, i.e. mean difference (BIAS) and RMSD is shown in <a class="reference internal" href="#performance-polar-truth-combined"><span class="std std-numref">Table 6</span></a>. For the different variables and observation directions. The results for the combined directions between the individual forward and backward scan results. The mean difference (BIAS) is very small for the SIC, CLW and MYI, while the other variables also show good performance. The standard deviation of the difference is a measure of how far the results spread around the mean difference. TWV and WS show very high values, but also the SSS and SIT values are quite large. The SIC as the value with the smallest bias, also has very low spread.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">calculate_overall_performances</span><span class="p">([</span><span class="n">scenep</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">gdata_true</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">,</span><span class="s">&quot;combined&quot;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="w"> </span><span class="n">markdown_table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s">&quot;multi parameter retrieval on the SCEPS polar scene. Forward (fw) and backward (bw) scans are shown separately and combined (cb).&quot;</span><span class="p">,</span><span class="s">&quot;polar-truth-combined&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/markdown&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="pst-scrollable-table-container"><table class="table" id="performance-polar-truth-combined">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">Performance metric for multi parameter retrieval on the SCEPS polar scene. Forward (fw) and backward (bw) scans are shown separately and combined (cb).</span><a class="headerlink" href="#performance-polar-truth-combined" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>fw mean(diff)</p></th>
<th class="head"><p>fw std(diff)</p></th>
<th class="head"><p>bw mean(diff)</p></th>
<th class="head"><p>bw std(diff)</p></th>
<th class="head"><p>cb mean(diff)</p></th>
<th class="head"><p>cb std(diff)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WS [m/s]</p></td>
<td><p>0.128</p></td>
<td><p>4.727</p></td>
<td><p>0.045</p></td>
<td><p>4.717</p></td>
<td><p>0.080</p></td>
<td><p>4.724</p></td>
</tr>
<tr class="row-odd"><td><p>TWV [kg/m²]</p></td>
<td><p>-1.915</p></td>
<td><p>5.743</p></td>
<td><p>-2.031</p></td>
<td><p>5.781</p></td>
<td><p>-1.984</p></td>
<td><p>5.756</p></td>
</tr>
<tr class="row-even"><td><p>CLW [kg/m²]</p></td>
<td><p>-0.017</p></td>
<td><p>0.098</p></td>
<td><p>-0.016</p></td>
<td><p>0.097</p></td>
<td><p>-0.017</p></td>
<td><p>0.097</p></td>
</tr>
<tr class="row-odd"><td><p>SST [K]</p></td>
<td><p>1.452</p></td>
<td><p>2.395</p></td>
<td><p>1.458</p></td>
<td><p>2.402</p></td>
<td><p>1.456</p></td>
<td><p>2.400</p></td>
</tr>
<tr class="row-even"><td><p>IST [K]</p></td>
<td><p>-5.467</p></td>
<td><p>6.178</p></td>
<td><p>-5.470</p></td>
<td><p>6.174</p></td>
<td><p>-5.469</p></td>
<td><p>6.176</p></td>
</tr>
<tr class="row-odd"><td><p>SIC [1]</p></td>
<td><p>-0.001</p></td>
<td><p>0.054</p></td>
<td><p>-0.000</p></td>
<td><p>0.054</p></td>
<td><p>-0.001</p></td>
<td><p>0.052</p></td>
</tr>
<tr class="row-even"><td><p>MYI [1]</p></td>
<td><p>0.179</p></td>
<td><p>0.415</p></td>
<td><p>0.180</p></td>
<td><p>0.415</p></td>
<td><p>0.180</p></td>
<td><p>0.415</p></td>
</tr>
<tr class="row-odd"><td><p>SIT [cm]</p></td>
<td><p>22.468</p></td>
<td><p>85.845</p></td>
<td><p>22.929</p></td>
<td><p>85.745</p></td>
<td><p>22.724</p></td>
<td><p>85.796</p></td>
</tr>
<tr class="row-even"><td><p>SSS [ppt]</p></td>
<td><p>-3.797</p></td>
<td><p>1.428</p></td>
<td><p>-3.819</p></td>
<td><p>1.452</p></td>
<td><p>-3.808</p></td>
<td><p>1.440</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>For a better insight into the different comparisons, namely, the retrieval on the simulator input and the reference data, we illustrate a comparison of the SIC for the forward and backward scan in <a class="reference internal" href="#ref-full-comparison-sic"><span class="std std-numref">Fig. 31</span></a>. The comparison of the retrieval on the input data and the reference data shows a very small difference, as expected. The difference is only visible at the ice edges and at the intermediate ice concentration where slight scan pattern are visible from the simulated L1b data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Statistics</span>
<span class="c">#DRAFT: plot reference, forward and backward with corresponding differences</span>
<span class="c">#layout: 3x3, first row: reference, forward, difference to reference</span>
<span class="c">#second row: retrieved on CIMR input, backward, difference to reference</span>
<span class="c">#third row: difference bteween reference and retrieved, difference between forward and backward, empty</span>

<span class="c">#reference is in variable gdata_true</span>
<span class="c">#retrieved on CIMR input is in variable gdata</span>
<span class="c">#retrieved on CIMR output is in variable data which is a Dict with keys &quot;forward&quot; and &quot;backward&quot;</span>

<span class="c">#variable ranges</span>

<span class="n">mmdict</span><span class="o">=</span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;ws&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s">&quot;twv&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s">&quot;clw&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span><span class="s">&quot;sst&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">250</span><span class="p">,</span><span class="mi">280</span><span class="p">],</span><span class="s">&quot;ist&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">250</span><span class="p">,</span><span class="mi">280</span><span class="p">],</span><span class="s">&quot;sic&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s">&quot;myi&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s">&quot;sit&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">],</span><span class="s">&quot;sss&quot;</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="mi">40</span><span class="p">])</span>

<span class="c">#variable names and units</span>
<span class="n">labdict</span><span class="o">=</span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;ws&quot;</span><span class="o">=&gt;</span><span class="s">&quot;wind speed [m/s]&quot;</span><span class="p">,</span><span class="s">&quot;twv&quot;</span><span class="o">=&gt;</span><span class="s">&quot;total water vapor [kg/m²]&quot;</span><span class="p">,</span><span class="s">&quot;clw&quot;</span><span class="o">=&gt;</span><span class="s">&quot;cloud liquid water [kg/m²]&quot;</span><span class="p">,</span><span class="s">&quot;sst&quot;</span><span class="o">=&gt;</span><span class="s">&quot;sea surface temperature [K]&quot;</span><span class="p">,</span><span class="s">&quot;ist&quot;</span><span class="o">=&gt;</span><span class="s">&quot;ice surface temperature [K]&quot;</span><span class="p">,</span><span class="s">&quot;sic&quot;</span><span class="o">=&gt;</span><span class="s">&quot;sea ice concentration [1]&quot;</span><span class="p">,</span><span class="s">&quot;myi&quot;</span><span class="o">=&gt;</span><span class="s">&quot;multi year ice fraction [1]&quot;</span><span class="p">,</span><span class="s">&quot;sit&quot;</span><span class="o">=&gt;</span><span class="s">&quot;first year ice thickness [cm]&quot;</span><span class="p">,</span><span class="s">&quot;sss&quot;</span><span class="o">=&gt;</span><span class="s">&quot;sea surface salinity [ppt]&quot;</span><span class="p">)</span>

<span class="n">sic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getfield</span><span class="p">(</span><span class="n">gdata_true</span><span class="p">,</span><span class="w"> </span><span class="ss">:sic</span><span class="p">)</span>

<span class="n">scene</span><span class="o">=</span><span class="s">&quot;polar&quot;</span>
<span class="c">#varname=&quot;twv&quot;</span>
<span class="k">for</span><span class="w"> </span><span class="n">varname</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;sic&quot;</span><span class="p">]</span><span class="c">#[&quot;ws&quot;,&quot;twv&quot;,&quot;clw&quot;,&quot;sst&quot;,&quot;ist&quot;,&quot;sic&quot;,&quot;myi&quot;,&quot;sit&quot;,&quot;sss&quot;]</span>

<span class="w">    </span><span class="c">#get variables from dicts for given varname</span>
<span class="w">    </span><span class="n">reference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getfield</span><span class="p">(</span><span class="n">gdata_true</span><span class="p">,</span><span class="kt">Symbol</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>
<span class="w">    </span><span class="n">input_retrieved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getfield</span><span class="p">(</span><span class="n">gdatap</span><span class="p">,</span><span class="kt">Symbol</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>
<span class="w">    </span><span class="n">forward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getfield</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">],</span><span class="w"> </span><span class="kt">Symbol</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>
<span class="w">    </span><span class="n">backward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getfield</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;backward&quot;</span><span class="p">],</span><span class="w"> </span><span class="kt">Symbol</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>

<span class="w">    </span><span class="c">#calculate maximum min max for difference plot for comparison</span>
<span class="w">    </span><span class="n">diffmax</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">quantile</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="n">isnan</span><span class="p">,</span><span class="w"> </span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">forward</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">backward</span><span class="p">)[</span><span class="o">:</span><span class="p">]),</span><span class="w"> </span><span class="mf">0.95</span><span class="p">),</span>
<span class="w">    </span><span class="n">quantile</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="n">isnan</span><span class="p">,</span><span class="w"> </span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">backward</span><span class="p">)[</span><span class="o">:</span><span class="p">]),</span><span class="w"> </span><span class="mf">0.95</span><span class="p">),</span>
<span class="w">    </span><span class="n">quantile</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="n">isnan</span><span class="p">,</span><span class="w"> </span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">forward</span><span class="p">)[</span><span class="o">:</span><span class="p">]),</span><span class="w"> </span><span class="mf">0.95</span><span class="p">),</span>
<span class="w">    </span><span class="n">quantile</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="n">isnan</span><span class="p">,</span><span class="w"> </span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">input_retrieved</span><span class="p">)[</span><span class="o">:</span><span class="p">]),</span><span class="w"> </span><span class="mf">0.95</span><span class="p">))</span>

<span class="w">    </span><span class="c">#colorbar_orientation = &quot;horizontal&quot;</span>
<span class="w">    </span><span class="n">colorbar_orientation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;vertical&quot;</span>

<span class="w">    </span><span class="n">mins</span><span class="p">,</span><span class="w"> </span><span class="n">maxs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mmdict</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span>
<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="p">))</span>
<span class="w">    </span><span class="c">#fig.suptitle(labdict[varname])</span>

<span class="w">    </span><span class="c"># upper left: reference</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">331</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="n">mins</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">maxs</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;</span><span class="si">$</span><span class="p">(</span><span class="n">labdict</span><span class="p">[</span><span class="n">varname</span><span class="p">])</span><span class="s"> reference&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="n">colorbar_orientation</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="c"># upper middle: forward</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">332</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;retrieved </span><span class="si">$varname</span><span class="s"> on CIMR output, forward&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">forward</span><span class="p">,</span><span class="w"> </span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="n">mins</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">maxs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="n">colorbar_orientation</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="c"># upper right: difference reference - forward</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">333</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;difference reference - forward&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">forward</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=-</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">,</span><span class="w"> </span><span class="n">cmap</span><span class="o">=</span><span class="s">&quot;RdBu_r&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="n">colorbar_orientation</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="c"># middle left: input_retrieved</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">334</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;retrieved </span><span class="si">$varname</span><span class="s"> on CIMR input&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">input_retrieved</span><span class="p">[</span><span class="n">landmask</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">    </span><span class="nb">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">input_retrieved</span><span class="p">,</span><span class="w"> </span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="n">mins</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">maxs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="n">colorbar_orientation</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="c"># middle middle: backward</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">335</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;retrieved </span><span class="si">$varname</span><span class="s"> on CIMR output, backward&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">backward</span><span class="p">[</span><span class="n">landmask</span><span class="p">]</span><span class="o">.=</span><span class="nb">NaN</span>
<span class="w">    </span><span class="nb">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">backward</span><span class="p">,</span><span class="w"> </span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=</span><span class="n">mins</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">maxs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="n">colorbar_orientation</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="c"># middle right: difference reference - backward</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">336</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;difference reference - backward&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">backward</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=-</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">,</span><span class="w"> </span><span class="n">cmap</span><span class="o">=</span><span class="s">&quot;RdBu_r&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="n">colorbar_orientation</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="c"># lower left: difference reference - input_retrieved</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">337</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;difference reference - CIMR input retrieved&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">input_retrieved</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=-</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">,</span><span class="w"> </span><span class="n">cmap</span><span class="o">=</span><span class="s">&quot;RdBu_r&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="n">colorbar_orientation</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="c"># lower middle: difference forward - backward</span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">338</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;difference forward - backward&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">forward</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">backward</span><span class="p">,</span><span class="w"> </span><span class="n">vmin</span><span class="o">=-</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">vmax</span><span class="o">=</span><span class="n">diffmax</span><span class="p">,</span><span class="w"> </span><span class="n">extent</span><span class="o">=</span><span class="n">leaextent</span><span class="p">,</span><span class="w"> </span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="p">,</span><span class="w"> </span><span class="n">cmap</span><span class="o">=</span><span class="s">&quot;RdBu_r&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="nb">im</span><span class="p">,</span><span class="w"> </span><span class="n">orientation</span><span class="o">=</span><span class="n">colorbar_orientation</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="w">    </span><span class="c">#done</span>
<span class="w">    </span><span class="c">#add space between subplots</span>
<span class="w">    </span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.08</span><span class="p">)</span>

<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Comparison of </span><span class="si">$</span><span class="p">(</span><span class="n">labdict</span><span class="p">[</span><span class="n">varname</span><span class="p">])</span><span class="s"> between reference dataset and retrieval Uppper row: reference, forward, difference to reference. Middle row: retrieved on CIMR input, backward, difference to reference. Lower row: difference between reference and retrieved, difference between forward and backward, empty.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ref_full_comparison_</span><span class="si">$</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="ref-full-comparison-sic">
<img alt="_images/figure_ref_full_comparison_sic.png" src="_images/figure_ref_full_comparison_sic.png" />
<figcaption>
<p><span class="caption-number">Fig. 31 </span><span class="caption-text">Comparison of sea ice concentration [1] between reference dataset and retrieval Uppper row: reference, forward, difference to reference. Middle row: retrieved on CIMR input, backward, difference to reference. Lower row: difference between reference and retrieved, difference between forward and backward, empty.</span><a class="headerlink" href="#ref-full-comparison-sic" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<section id="correction-of-oza-variation">
<h3>Correction of OZA variation<a class="headerlink" href="#correction-of-oza-variation" title="Link to this heading">#</a></h3>
<p>The SCEPS polar scene in the simulated CIMR L1b format shows a strong variation with the individual scans due to slight variation in OZA. As a first attempt we correct this variation empirically as described in <a class="reference internal" href="baseline_algorithm_definition.html#oza"><span class="std std-ref">Correction for variation in incidence angle</span></a> and apply the retrieval to the corrected data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vmin</span><span class="o">=</span><span class="mi">60</span>
<span class="n">vmax</span><span class="o">=</span><span class="mi">260</span>
<span class="n">cmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">prism</span><span class="p">;</span>
<span class="n">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;v&quot;</span><span class="p">,</span><span class="s">&quot;v corrected&quot;</span><span class="p">,</span><span class="s">&quot;h&quot;</span><span class="p">,</span><span class="s">&quot;h corrected&quot;</span><span class="p">]</span>
<span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">axs</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">band</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">([</span><span class="s">&quot;C_BAND&quot;</span><span class="p">,</span><span class="s">&quot;X_BAND&quot;</span><span class="p">,</span><span class="s">&quot;KU_BAND&quot;</span><span class="p">,</span><span class="s">&quot;KA_BAND&quot;</span><span class="p">])</span>
<span class="w">        </span><span class="n">cbanddata</span><span class="o">=</span><span class="n">get_data_for_band</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scenep</span><span class="o">.</span><span class="n">l1b</span><span class="p">,</span><span class="n">band</span><span class="p">,</span><span class="s">&quot;forward&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">cbanddata_corr</span><span class="o">=</span><span class="n">get_data_for_band</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scenep</span><span class="o">.</span><span class="n">l1b</span><span class="p">,</span><span class="n">band</span><span class="p">,</span><span class="s">&quot;forward&quot;</span><span class="p">,</span><span class="n">oza_corr</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
<span class="w">        </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cbanddata</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">cbanddata</span><span class="o">.</span><span class="n">lon</span>

<span class="w">        </span><span class="n">vproj</span><span class="o">=</span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">cbanddata</span><span class="o">.</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lea</span><span class="p">)</span>
<span class="w">        </span><span class="n">c</span><span class="o">=</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vproj</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
<span class="w">        </span><span class="n">vproj</span><span class="o">=</span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">cbanddata_corr</span><span class="o">.</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lea</span><span class="p">)</span>
<span class="w">        </span><span class="n">c</span><span class="o">=</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vproj</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
<span class="w">        </span><span class="n">vproj</span><span class="o">=</span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">cbanddata</span><span class="o">.</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lea</span><span class="p">)</span>
<span class="w">        </span><span class="n">c</span><span class="o">=</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vproj</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
<span class="w">        </span><span class="n">vproj</span><span class="o">=</span><span class="n">project_data_to_area_nn</span><span class="p">(</span><span class="n">cbanddata_corr</span><span class="o">.</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lea</span><span class="p">)</span>
<span class="w">        </span><span class="n">c</span><span class="o">=</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vproj</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
<span class="w">        </span><span class="c">#pyplot.colorbar(c)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">4</span>
<span class="w">        </span><span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.82</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="s">&quot;X&quot;</span><span class="p">,</span><span class="s">&quot;KU&quot;</span><span class="p">,</span><span class="s">&quot;KA&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">va</span><span class="o">=</span><span class="s">&quot;center&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ha</span><span class="o">=</span><span class="s">&quot;center&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rotation</span><span class="o">=</span><span class="s">&quot;vertical&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="w">        </span><span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9</span><span class="p">,</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">va</span><span class="o">=</span><span class="s">&quot;center&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ha</span><span class="o">=</span><span class="s">&quot;center&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">ax</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span>
<span class="w">        </span><span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&quot;off&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="c">#display(&quot;image/png&quot;,fig)</span>
<span class="w">    </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Illustration of OZA correction for the forward scan for the four bands C, X, KU, KA. The first and third column shows the original data in v and h polarization, the second and fourth column the data after OZA correction in v and h polarization, respectively.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;oza_correction&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="oza-correction">
<img alt="_images/figure_oza_correction.png" src="_images/figure_oza_correction.png" />
<figcaption>
<p><span class="caption-number">Fig. 32 </span><span class="caption-text">Illustration of OZA correction for the forward scan for the four bands C, X, KU, KA. The first and third column shows the original data in v and h polarization, the second and fourth column the data after OZA correction in v and h polarization, respectively.</span><a class="headerlink" href="#oza-correction" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>The color map shown in <a class="reference internal" href="#oza-correction"><span class="std std-numref">Fig. 32</span></a> is a cyclic color map, where small differences are visible as changes in color, while the color itself has no meaning in terms of the absolute value as it occurs multiple times for different values. This is useful to illustrate small differences in homogeneous areas at different absolute values. In this case, the repetitive pattern of the OZA can be seen in the data in the vertical and horizontal polarization, while this pattern is mostly removed in the corrected data. Only in KA-band at vertical polarization the OZA pattern is still slightly visible at the bottom right part of the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">scenepnc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Dict</span><span class="p">()</span>
<span class="k">for</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;forward&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">test2datac</span><span class="p">,</span><span class="n">test2derror</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">project_data</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scenep</span><span class="o">.</span><span class="n">l1b</span><span class="p">,</span><span class="s">&quot;C_BAND&quot;</span><span class="p">,</span><span class="n">dir</span><span class="p">)</span>
<span class="w">    </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">lltoxy</span><span class="o">.</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">last</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="n">pygc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="w">    </span><span class="n">GC</span><span class="o">.</span><span class="n">gc</span><span class="p">()</span>
<span class="w">    </span><span class="n">dat</span><span class="p">,</span><span class="n">err</span><span class="p">,</span><span class="n">res</span><span class="o">=</span><span class="n">run_oem</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">test2datac</span><span class="p">))</span>
<span class="w">    </span><span class="n">scenepnc</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p>Here we show the retrieval applied on the backward scan of the uncorrected data <a class="reference internal" href="#uncorrected-all-params"><span class="std std-numref">Fig. 33</span></a> and corrected <a class="reference internal" href="#corrected-all-params"><span class="std std-numref">Fig. 34</span></a> data as comparison. The scan lines are mainly visible in variables where small changes in brightness temperatures have a big impact on the retrieval result. It is least visible over high ice concentrations and thus in the multi year ice fraction and also in the sea ice concentration retrieval in general.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">scenepnc</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">,</span><span class="n">swath</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,</span><span class="ss">:land</span><span class="p">),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:false</span><span class="p">)</span>
<span class="w">    </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;The uncorrected data shows significant OZA variation in the retrieved quantities.&quot;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">description</span><span class="p">,</span><span class="s">&quot;uncorrected_all_params&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="uncorrected-all-params">
<img alt="_images/figure_uncorrected_all_params.png" src="_images/figure_uncorrected_all_params.png" />
<figcaption>
<p><span class="caption-number">Fig. 33 </span><span class="caption-text">The uncorrected data shows significant OZA variation in the retrieved quantities.</span><a class="headerlink" href="#uncorrected-all-params" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="n">fig</span><span class="o">=</span><span class="w"> </span><span class="n">plot_all_params</span><span class="p">(</span><span class="n">scenep</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">,</span><span class="n">swath</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="ss">:sic</span><span class="p">,</span><span class="ss">:land</span><span class="p">),</span><span class="n">errors</span><span class="o">=</span><span class="ss">:false</span><span class="p">)</span>
<span class="w">    </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;The backward scan of the corrected data has less OZA variation and more consistent retrieval results compared to the uncorrected data.&quot;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">plot_with_caption</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">description</span><span class="p">,</span><span class="s">&quot;corrected_all_params&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="corrected-all-params">
<img alt="_images/figure_corrected_all_params.png" src="_images/figure_corrected_all_params.png" />
<figcaption>
<p><span class="caption-number">Fig. 34 </span><span class="caption-text">The backward scan of the corrected data has less OZA variation and more consistent retrieval results compared to the uncorrected data.</span><a class="headerlink" href="#corrected-all-params" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="saving-results-example">
<h3>Saving results (Example)<a class="headerlink" href="#saving-results-example" title="Link to this heading">#</a></h3>
<p>A few functions can be called to start the processing of CIMR L1b data and transform the result to a netCDF file. An example is shown here. We start with the <code class="docutils literal notranslate"><span class="pre">project_data</span></code> function to get to a common grid for all channels. On this we perform the retrieval using the <code class="docutils literal notranslate"><span class="pre">run_oem</span></code> function. The results are then stored in a named tuple with the with <code class="docutils literal notranslate"><span class="pre">data</span></code>, <code class="docutils literal notranslate"><span class="pre">err</span></code> and <code class="docutils literal notranslate"><span class="pre">lat</span></code> and <code class="docutils literal notranslate"><span class="pre">lon</span></code> keys for each viewing direction. This is stored for each viewing direction in another named tuple with the corresponding fields <code class="docutils literal notranslate"><span class="pre">forward</span></code> or <code class="docutils literal notranslate"><span class="pre">backward</span></code>. On this nested structure we can call the <code class="docutils literal notranslate"><span class="pre">store_output</span></code> function to save the results to a netCDF file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># example to write out a file</span>
<span class="c">#forward </span>
<span class="n">findata</span><span class="p">,</span><span class="n">finerror</span><span class="p">,</span><span class="n">flat</span><span class="p">,</span><span class="n">flon</span><span class="o">=</span><span class="n">project_data</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scene2</span><span class="o">.</span><span class="n">l1b</span><span class="p">,</span><span class="s">&quot;C_BAND&quot;</span><span class="p">,</span><span class="s">&quot;forward&quot;</span><span class="p">)</span>
<span class="n">fdat</span><span class="p">,</span><span class="n">ferr</span><span class="p">,</span><span class="n">fres</span><span class="p">,</span><span class="n">fit</span><span class="o">=</span><span class="n">run_oem</span><span class="p">(</span><span class="n">findata</span><span class="p">,</span><span class="n">band_error</span><span class="o">=</span><span class="n">finerror</span><span class="p">)</span>
<span class="c">#backward</span>
<span class="n">bindata</span><span class="p">,</span><span class="n">binerror</span><span class="p">,</span><span class="n">blat</span><span class="p">,</span><span class="n">blon</span><span class="o">=</span><span class="n">project_data</span><span class="p">(</span><span class="n">fns</span><span class="o">.</span><span class="n">scene2</span><span class="o">.</span><span class="n">l1b</span><span class="p">,</span><span class="s">&quot;C_BAND&quot;</span><span class="p">,</span><span class="s">&quot;backward&quot;</span><span class="p">)</span>
<span class="n">bdat</span><span class="p">,</span><span class="n">berr</span><span class="p">,</span><span class="n">bres</span><span class="p">,</span><span class="n">bit</span><span class="o">=</span><span class="n">run_oem</span><span class="p">(</span><span class="n">bindata</span><span class="p">,</span><span class="n">band_error</span><span class="o">=</span><span class="n">binerror</span><span class="p">)</span>

<span class="n">thedata</span><span class="o">=</span><span class="p">(;</span><span class="n">forward</span><span class="o">=</span><span class="p">(;</span><span class="n">data</span><span class="o">=</span><span class="n">fdat</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="n">ferr</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="n">flat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">flon</span><span class="p">,</span><span class="n">res</span><span class="o">=</span><span class="n">fres</span><span class="p">,</span><span class="n">it</span><span class="o">=</span><span class="n">fit</span><span class="p">),</span>
<span class="w">         </span><span class="n">backward</span><span class="o">=</span><span class="p">(;</span><span class="n">data</span><span class="o">=</span><span class="n">bdat</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="n">berr</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="n">blat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">blon</span><span class="p">,</span><span class="n">res</span><span class="o">=</span><span class="n">bres</span><span class="p">,</span><span class="n">it</span><span class="o">=</span><span class="n">bit</span><span class="p">))</span>

<span class="n">store_output</span><span class="p">(</span><span class="s">&quot;test2_forward.nc&quot;</span><span class="p">,</span><span class="n">thedata</span><span class="p">,</span><span class="s">&quot;ease2_nh&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(xsize, ysize, length(x), length(y)) = (1440, 1440, 1440, 1440)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sys:1: RuntimeWarning: invalid value encountered in cast
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>The Multi Parameter Retrieval <a class="reference internal" href="acronyms.html#term-MPR"><span class="xref std std-term">MPR</span></a>, has been demonstrated on the two CIMR
DEVALGO test cards, as well as on the SCEPS polar scene. For the two
DEVALGO test cards, the retrieval was applied on the input data to the CIMR
simulator, as well as on the L1b data, which is the output of the CIMR
simulator. This way of performance evaluation is used to assess the impact of
the satellite characteristics on the retrieval, in particular the combination
of different resolutions of the channels. As a performance metric for these
scene, the mean difference is calculated, which can be referred to as BIAS. In
addition the standard deviation of differences are assessed which is
technically the mean difference from the BIAS. The performance of the retrieval
on the L1b data is very similar to the performance on the input data. This is
expected as the simulator is slightly modifying the input brightness
temperatures. The differences are only visible at the ice edges and at the
intermediate ice concentration where slight scan pattern are visible from the
simulated L1b data. The performance of the retrieval on the SCEPS polar scene
is also very similar to the performance on the DEVALGO test cards.
The OZA variation in the SCEPS polar scene is corrected empirically and
the retrieval is applied to the corrected data. The visible scan lines from the
OZA variation are mainly removed in the all retrieved quantities on the OZA
corrected data. The addition of the sea surface salinity to the retrieval could
be accomplished but the sea surface salinity comes with a high uncertainty in
this retrieval. Interestingly, the retrieved SSS is showing the OZA pattern,
even though it is mostly influenced by L-band TBs which is most sensitive to
salinity. At L-band CIMR only observes with one single feed horn so that OZA
variation is not present for neighboring scan lines. The OZA pattern in the SSS
retrieval is propagating from the strong OZA effect on wind speed, which can be
seen in multiple frequencies, including KU-band and KA-band, where the OZA
effect is strongest. In the OZA corrected version, no pattern is visible in
the SSS retrieval. Additional work will need to be done to understand how this
OZA pattern propagates through different frequencies and what it means for
retrievals of other parameters such as wind speed or temperature.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.10"
        },
        kernelOptions: {
            name: "julia-1.10",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.10'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="first_assessment.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">First assessment of the algorithm</p>
      </div>
    </a>
    <a class="right-next"
       href="references.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Bibliography</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-of-the-reading-routines-for-the-data-handling">Illustration of the reading routines for the data handling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-of-l1b-data-without-resampling">Illustration of L1b data without resampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application-of-the-retrieval-on-the-l1b-data">Application of the retrieval on the L1b data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#devalgo-test-scene-1-radiometric-scene">DEVALGO test scene 1 - Radiometric scene</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-surface-classes-and-true-brightness-temperatures">Overview of surface classes and true brightness temperatures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieval-before-and-after-the-satellite-simulator-for-the-radiometric-scene">Retrieval before and after the satellite simulator for the radiometric scene</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-metrics-for-the-radiometric-scene">Performance metrics for the radiometric scene</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#devalgo-test-scene-2-geometric-scene">DEVALGO test scene 2 - Geometric scene</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieval-before-and-after-the-satellite-simulator-for-the-geometric-scene">Retrieval before and after the satellite simulator for the geometric scene</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-metrics-for-the-geometric-scene">Performance metrics for the geometric scene</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-scene-sceps-polar-scene">Test scene SCEPS - Polar scene</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correction-of-oza-variation">Correction of OZA variation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-results-example">Saving results (Example)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Marcus Huntemann, Janna Rückert, Gunnar Spreen
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
This ATBD was developed in the context of the ESA-funded CIMR DEVALGO study (2022-2024) (contract 4000137493).
<br>
ESA is not responsible in any way for the content of this document.
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>